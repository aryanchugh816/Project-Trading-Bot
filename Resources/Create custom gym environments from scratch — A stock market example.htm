<!doctype html><html lang="en"><head><script>!function(c,f){var t,o,i,e=[],r={passive:!0,capture:!0},n=new Date,a="pointerup",u="pointercancel";function p(n,e){t||(t=e,o=n,i=new Date,w(f),s())}function s(){0<=o&&o<i-n&&(e.forEach(function(n){n(o,t)}),e=[])}function l(n){if(n.cancelable){var e=(1e12<n.timeStamp?new Date:performance.now())-n.timeStamp;"pointerdown"==n.type?function(n,e){function t(){p(n,e),i()}function o(){i()}function i(){f(a,t,r),f(u,o,r)}c(a,t,r),c(u,o,r)}(e,n):p(e,n)}}function w(e){["click","mousedown","keydown","touchstart","pointerdown"].forEach(function(n){e(n,l,r)})}w(c),self.perfMetrics=self.perfMetrics||{},self.perfMetrics.onFirstInputDelay=function(n){e.push(n),s()}}(addEventListener,removeEventListener)</script><title data-rh="true">Create custom gym environments from scratch — A stock market example</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2019-10-17T04:40:54.380Z"/><meta data-rh="true" name="title" content="Create custom gym environments from scratch — A stock market example"/><meta data-rh="true" property="og:title" content="Creating a Custom OpenAI Gym Environment for Stock Trading"/><meta data-rh="true" property="twitter:title" content="Creating a Custom OpenAI Gym Environment for Stock Trading"/><meta data-rh="true" name="twitter:site" content="@TDataScience"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/be532be3910e"/><meta data-rh="true" property="al:android:url" content="medium://p/be532be3910e"/><meta data-rh="true" property="al:ios:url" content="medium://p/be532be3910e"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="OpenAI’s gym is an awesome package that allows you to create custom reinforcement learning agents. It comes with quite a few pre-built environments like CartPole, MountainCar, and a ton of free…"/><meta data-rh="true" property="og:description" content="OpenAI’s gym is an awesome package that allows you to create custom reinforcement learning agents. It comes with quite a few pre-built…"/><meta data-rh="true" property="twitter:description" content="OpenAI’s gym is an awesome package that allows you to create custom reinforcement learning agents. It comes with quite a few pre-built…"/><meta data-rh="true" property="og:url" content="https://towardsdatascience.com/creating-a-custom-openai-gym-environment-for-stock-trading-be532be3910e"/><meta data-rh="true" property="al:web:url" content="https://towardsdatascience.com/creating-a-custom-openai-gym-environment-for-stock-trading-be532be3910e"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/max/1200/1*3UNtfZrmEiv3XFKs_xaRcA.jpeg"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/max/1200/1*3UNtfZrmEiv3XFKs_xaRcA.jpeg"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" property="article:author" content="https://towardsdatascience.com/@notadamking"/><meta data-rh="true" name="twitter:creator" content="@notadamking"/><meta data-rh="true" name="author" content="Adam King"/><meta data-rh="true" name="robots" content="index,follow"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" name="twitter:label1" value="Reading time"/><meta data-rh="true" name="twitter:data1" value="8 min read"/><meta data-rh="true" name="parsely-post-id" content="be532be3910e"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://cdn-images-1.medium.com/fit/c/152/152/1*8I-HPL0bfoIzGied-dzOvA.png"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://cdn-images-1.medium.com/fit/c/120/120/1*8I-HPL0bfoIzGied-dzOvA.png"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://cdn-images-1.medium.com/fit/c/76/76/1*8I-HPL0bfoIzGied-dzOvA.png"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://cdn-images-1.medium.com/fit/c/60/60/1*8I-HPL0bfoIzGied-dzOvA.png"/><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg" color="#171717"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/e/sr/latin/e/ssr/latin/e/ssb/latin/m2.css"/><link data-rh="true" rel="author" href="https://towardsdatascience.com/@notadamking"/><link data-rh="true" rel="canonical" href="https://towardsdatascience.com/creating-a-custom-openai-gym-environment-for-stock-trading-be532be3910e"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/be532be3910e"/><link data-rh="true" rel="icon" href="https://miro.medium.com/fit/c/256/256/1*ChFMdf--f5jbm-AYv6VdYA@2x.png"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1200\u002F1*3UNtfZrmEiv3XFKs_xaRcA.jpeg"],"url":"https:\u002F\u002Ftowardsdatascience.com\u002Fcreating-a-custom-openai-gym-environment-for-stock-trading-be532be3910e","dateCreated":"2019-04-10T07:15:51.225Z","datePublished":"2019-04-10T07:15:51.225Z","dateModified":"2019-10-17T04:40:54.615Z","headline":"Creating a Custom OpenAI Gym Environment for Stock Trading","name":"Creating a Custom OpenAI Gym Environment for Stock Trading","description":"OpenAI’s gym is an awesome package that allows you to create custom reinforcement learning agents. It comes with quite a few pre-built environments like CartPole, MountainCar, and a ton of free…","identifier":"be532be3910e","keywords":["Lite:true","Tag:Machine Learning","Tag:Stock Trading","Tag:Deep Learning","Tag:Openai Gym","Tag:Stock Market","Publication:towards-data-science","Elevated:false","LockedPostSource:LOCKED_POST_SOURCE_UGC","LayerCake:4"],"author":{"@type":"Person","name":"Adam King","url":"https:\u002F\u002Ftowardsdatascience.com\u002F@notadamking"},"creator":["Adam King"],"publisher":{"@type":"Organization","name":"Towards Data Science","url":"towardsdatascience.com","logo":{"@type":"ImageObject","width":165,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F330\u002F1*mG6i4Bh_LgixUYXJgQpYsg@2x.png"}},"mainEntityOfPage":"https:\u002F\u002Ftowardsdatascience.com\u002Fcreating-a-custom-openai-gym-environment-for-stock-trading-be532be3910e","isAccessibleForFree":"False","hasPart":{"@type":"WebPageElement","isAccessibleForFree":"False","cssSelector":".meteredContent"}}</script><script data-rh="true" >(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-24232453-2', 'auto');
ga('send', 'pageview');</script><link rel="preload" href="https://cdn.optimizely.com/js/16180790160.js" as="script"><style type="text/css" data-fela-rehydration="533" data-fela-type="STATIC">html{box-sizing:border-box}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}</style><style type="text/css" data-fela-rehydration="533" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@-moz-keyframes k1{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@keyframes k1{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}</style><style type="text/css" data-fela-rehydration="533" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{height:100vh}.m{width:100vw}.n{display:flex}.o{align-items:center}.p{justify-content:center}.q{fill:rgba(0, 0, 0, 0.84)}.r{display:block}.s{position:absolute}.t{top:0}.u{left:0}.v{right:0}.w{z-index:500}.x{box-shadow:0 4px 12px 0 rgba(0, 0, 0, 0.05)}.ag{max-width:1192px}.ah{min-width:0}.ai{width:100%}.aj{height:65px}.am{flex:1 0 auto}.an{flex:0 0 auto}.ao{visibility:hidden}.ap{margin-left:16px}.aq{font-family:medium-content-sans-serif-font, "Lucida Grande", "Lucida Sans Unicode", "Lucida Sans", Geneva, Arial, sans-serif}.ar{font-style:normal}.as{line-height:20px}.at{font-size:15.8px}.au{letter-spacing:0px}.av{color:rgba(0, 0, 0, 0.54)}.aw{fill:rgba(0, 0, 0, 0.54)}.ax{color:rgba(90, 118, 144, 1)}.ay{fill:rgba(102, 138, 170, 1)}.az{font-size:inherit}.ba{border:inherit}.bb{font-family:inherit}.bc{letter-spacing:inherit}.bd{font-weight:inherit}.be{padding:0}.bf{margin:0}.bg:hover{cursor:pointer}.bh:hover{color:rgba(84, 108, 131, 1)}.bi:hover{fill:rgba(90, 118, 144, 1)}.bj:focus{outline:none}.bk:disabled{cursor:default}.bl:disabled{color:rgba(140, 93, 255, 0.5)}.bm:disabled{fill:rgba(140, 93, 255, 0.5)}.bn{border-top:none}.bo{background-color:rgba(53, 88, 118, 1)}.bq{height:54px}.br{overflow:hidden}.bs{margin-right:40px}.bt{height:36px}.bu{width:100px}.bv{overflow:auto}.bw{flex:0 1 auto}.bx{list-style-type:none}.by{line-height:40px}.bz{white-space:nowrap}.ca{overflow-x:auto}.cb{align-items:flex-start}.cc{margin-top:20px}.cd{padding-top:20px}.ce{height:80px}.cf{height:20px}.cg{margin-right:15px}.ch{margin-left:15px}.ci:first-child{margin-left:0}.cj{min-width:1px}.ck{background-color:rgba(197, 210, 225, 1)}.cl{font-weight:300}.cm{font-size:15px}.cn{color:rgba(197, 210, 225, 1)}.co{text-transform:uppercase}.cp{letter-spacing:1px}.cq{color:inherit}.cr{fill:inherit}.cs:hover{color:rgba(251, 255, 255, 1)}.ct:hover{fill:rgba(233, 241, 250, 1)}.cu:disabled{color:rgba(150, 171, 191, 1)}.cv:disabled{fill:rgba(150, 171, 191, 1)}.cw{margin-bottom:0px}.cx{height:119px}.da{padding-left:24px}.db{padding-right:24px}.dc{margin-left:auto}.dd{margin-right:auto}.de{max-width:728px}.df{box-sizing:border-box}.dg{flex-direction:column}.dh{top:calc(100vh + 100px)}.di{bottom:calc(100vh + 100px)}.dj{width:10px}.dk{pointer-events:none}.dl{word-break:break-word}.dm{word-wrap:break-word}.dn:after{display:block}.do:after{content:""}.dp:after{clear:both}.dq{max-width:680px}.dr{line-height:1.23}.ds{letter-spacing:0}.dt{color:rgba(0, 0, 0, 0.84)}.du{font-family:medium-content-title-font, Georgia, Cambria, "Times New Roman", Times, serif}.ef{margin-bottom:-0.27em}.el{margin-top:32px}.em{justify-content:space-between}.eq{position:relative}.er{width:48px}.es{height:48px}.et{fill:rgba(3, 168, 124, 1)}.eu{flex-direction:row}.ev{width:calc(100% + 25px)}.ew{height:calc(100% + 25px)}.ex{top:50%}.ey{left:50%}.ez{transform:translateX(-50%) translateY(-50%)}.fa{border-radius:50%}.fb{margin-left:12px}.fc{margin-bottom:2px}.fe{font-size:16px}.ff{max-height:20px}.fg{text-overflow:ellipsis}.fh{display:-webkit-box}.fi{-webkit-line-clamp:1}.fj{-webkit-box-orient:vertical}.fk:hover{text-decoration:underline}.fl:disabled{color:rgba(0, 0, 0, 0.54)}.fm:disabled{fill:rgba(0, 0, 0, 0.54)}.fn{margin-left:8px}.fo{padding:0px 8px}.fp{background:0}.fq{border-color:rgba(0, 0, 0, 0.54)}.fr:hover{color:rgba(0, 0, 0, 0.97)}.fs:hover{fill:rgba(0, 0, 0, 0.97)}.ft:hover{border-color:rgba(0, 0, 0, 0.84)}.fu:disabled{fill:rgba(0, 0, 0, 0.76)}.fv:disabled{border-color:rgba(0, 0, 0, 0.2)}.fw:disabled{cursor:inherit}.fx:disabled:hover{color:rgba(0, 0, 0, 0.54)}.fy:disabled:hover{fill:rgba(0, 0, 0, 0.76)}.fz:disabled:hover{border-color:rgba(0, 0, 0, 0.2)}.ga{border-radius:4px}.gb{line-height:18px}.gc{border-width:1px}.gd{border-style:solid}.ge{display:inline-block}.gf{text-decoration:none}.gg{align-items:flex-end}.go{padding-right:6px}.gp:hover{color:rgba(0, 0, 0, 0.9)}.gq:hover{fill:rgba(0, 0, 0, 0.9)}.gr{margin-right:8px}.gs{margin-right:-6px}.gt{line-height:1.58}.gu{letter-spacing:-0.004em}.gv{font-family:medium-content-serif-font, Georgia, Cambria, "Times New Roman", Times, serif}.hg{margin-bottom:-0.46em}.hh{background-color:rgba(0, 0, 0, 0.05)}.hi{padding:2px 4px}.hj{font-size:75%}.hk> strong{font-family:inherit}.hl{font-family:Menlo, Monaco, "Courier New", Courier, monospace}.hm{background-repeat:repeat-x}.hn{background-image:linear-gradient(to right,rgba(0, 0, 0, 0.84) 100%,rgba(0, 0, 0, 0.84) 0);background-image:url('data:image/svg+xml;utf8,<svg preserveAspectRatio="none" viewBox="0 0 1 1" xmlns="http://www.w3.org/2000/svg"><line x1="0" y1="0" x2="1" y2="1" stroke="rgba(0, 0, 0, 0.84)" /></svg>')}.ho{background-size:1px 1px}.hp{background-position:0 1.05em;background-position:0 calc(1em + 1px)}.hq{font-weight:700}.hr{font-style:italic}.hx{padding:20px}.hy{background:rgba(0, 0, 0, 0.05)}.hz{line-height:1.18}.ia{letter-spacing:-0.022em}.ib{margin-top:-0.09em}.ic{margin-bottom:-0.09em}.id{white-space:pre-wrap}.ij{line-height:1.12}.ik{font-weight:600}.it{margin-bottom:-0.28em}.iz{max-width:4608px}.ja{clear:both}.jb{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}.jc{cursor:zoom-in}.jd{z-index:auto}.je{opacity:0}.jf{transition:opacity 100ms 400ms}.jg{height:100%}.jh{will-change:transform}.ji{transform:translateZ(0)}.jj{margin:auto}.jk{padding-bottom:75%}.jl{filter:blur(20px)}.jm{transform:scale(1.1)}.jn{visibility:visible}.jo{background:rgba(255, 255, 255, 1)}.jp{padding-bottom:50%}.ka{margin-bottom:-0.31em}.kg{box-shadow:0 1px 4px rgba(0, 0, 0, 0.1), inset 0 0 0 1px rgba(0, 0, 0, 0.1)}.kh{padding:0px}.ki{padding:16px 20px}.kj{flex:1 1 auto}.kl{font-size:18px}.km{max-height:40px}.kn{-webkit-line-clamp:2}.ko{margin-top:8px}.kp{margin-top:12px}.kq{width:160px}.kr{background-image:url(https://miro.medium.com/max/320/1*r7XItmcyWv76mso08vncpw.jpeg)}.ks{background-origin:border-box}.kt{background-size:cover}.ku{height:167px}.kv{background-position:50% 50%}.kw{max-width:100%}.kx{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.1)}.ky{font-family:medium-content-slab-serif-font, Georgia, Cambria, "Times New Roman", Times, serif}.kz{font-size:28px}.la{border:none}.lb{margin-top:30px}.lc{text-align:center}.ld:before{content:"..."}.le:before{letter-spacing:0.6em}.lf:before{text-indent:0.6em}.lg:before{font-style:italic}.lh:before{line-height:1.4}.li{background-image:url(https://miro.medium.com/max/320/0*P72bPmqLD2-R47En)}.lj{box-shadow:inset 3px 0 0 0 rgba(0, 0, 0, 0.84)}.lk{padding-left:23px}.ll{margin-left:-20px}.lm{background-image:url(https://miro.medium.com/max/320/0*1J-9dzACdixhIcDA)}.ln{will-change:opacity}.lo{position:fixed}.lp{width:188px}.lq{transform:translateX(406px)}.lr{top:calc(65px + 54px + 14px)}.lu{top:calc(65px + 54px + 40px)}.lw{width:131px}.lx{padding-bottom:28px}.ly{border-bottom:1px solid rgba(0, 0, 0, 0.1)}.lz{padding-bottom:20px}.ma{padding-top:2px}.mb{max-height:120px}.mc{-webkit-line-clamp:6}.md{padding:4px 12px}.me{border-color:rgba(102, 138, 170, 1)}.mf:hover{border-color:rgba(90, 118, 144, 1)}.mg{padding-top:28px}.mh{margin-bottom:19px}.mi{margin-left:-3px}.mj{margin-right:5px}.mk{outline:0}.ml{border:0}.mm{user-select:none}.mn{cursor:pointer}.mo> svg{pointer-events:none}.mp:active{border-style:none}.mq{-webkit-user-select:none}.mr:focus{fill:rgba(90, 118, 144, 1)}.ms{margin-top:5px}.mt button{text-align:left}.mu{margin-top:40px}.mv{flex-wrap:wrap}.mw{margin-top:25px}.mx{margin-bottom:8px}.my{border-radius:3px}.mz{padding:5px 10px}.na{line-height:22px}.nb{margin-top:15px}.nc{margin-right:16px}.nd{border:1px solid rgba(0, 0, 0, 0.1)}.ne{height:60px}.nf{width:60px}.ns:active{border-style:solid}.nt{z-index:2}.nv{padding-right:8px}.nw{padding-top:32px}.nx{border-top:1px solid rgba(0, 0, 0, 0.1)}.ny{margin-bottom:25px}.nz{margin-bottom:32px}.oa{min-height:80px}.of{width:80px}.og{padding-left:102px}.oi{letter-spacing:0.05em}.oj{margin-bottom:6px}.ok{line-height:36px}.ol{max-width:555px}.om{max-width:450px}.on{line-height:24px}.oo{display:none}.oq{max-width:550px}.or{padding-top:25px}.os{color:rgba(0, 0, 0, 0.76)}.ot{opacity:1}.ou{border:1px solid rgba(102, 138, 170, 1)}.ov{margin-top:64px}.ow{background-color:rgba(0, 0, 0, 0.02)}.ox{margin:32px 0}.oz{padding-bottom:8px}.pa{font-size:22px}.pb{line-height:28px}.ql{flex-grow:0}.rf{margin-bottom:12px}.rh{margin-bottom:16px}.rj{padding-bottom:66.46341463414635%}.rk{background-image:url(https://miro.medium.com/max/656/0*ZSR2HwcRxTMtyDBM)}.rl{margin-bottom:4px}.rn{font-weight:500}.ro{font-size:24px}.rp{line-height:32px}.rq{letter-spacing:0em}.rr{margin-right:10px}.rs{width:40px}.rt{height:40px}.ru{fill:rgba(0, 0, 0, 0.76)}.rv:focus{fill:rgba(0, 0, 0, 0.54)}.rw:hover{fill:rgba(0, 0, 0, 0.54)}.rx{border-right:1px solid rgba(0, 0, 0, 0.1)}.ry{width:1px}.rz{background-image:url(https://miro.medium.com/max/656/1*0zc5FpwQKOm5d7bIbozXCA.jpeg)}.sa{background-image:url(https://miro.medium.com/max/656/1*ISt7IxE0_46F5yCEspq_oQ.jpeg)}.sb{padding:60px 0}.sc{background-color:rgba(0, 0, 0, 0.9)}.st{padding-bottom:48px}.su{border-bottom:1px solid rgba(255, 255, 255, 0.54)}.sv{margin:0 -12px}.sw{margin:0 12px}.sx{flex:1 1 0}.sy{padding-bottom:12px}.sz:hover{color:rgba(255, 255, 255, 0.99)}.ta:hover{fill:rgba(255, 255, 255, 0.99)}.tb:disabled{color:rgba(255, 255, 255, 0.7)}.tc:disabled{fill:rgba(255, 255, 255, 0.7)}.td{color:rgba(255, 255, 255, 0.98)}.te{fill:rgba(255, 255, 255, 0.98)}.tf{text-align:inherit}.tg{font-size:21.6px}.th{letter-spacing:-0.32px}.ti{color:rgba(255, 255, 255, 0.7)}.tj{fill:rgba(255, 255, 255, 0.7)}.tk{text-decoration:underline}.tl{padding-top:8px}.tm{width:200px}</style><style type="text/css" data-fela-rehydration="533" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.af{margin:0 64px}.ed{font-size:40px}.ee{margin-top:0.78em}.ek{line-height:48px}.gn{margin-left:30px}.he{font-size:21px}.hf{margin-top:2em}.hw{margin-top:56px}.ii{margin-top:1.91em}.ir{font-size:34px}.is{margin-top:1.95em}.iy{margin-top:0.86em}.jy{font-size:26px}.jz{margin-top:1.72em}.kf{margin-top:32px}.po{width:calc(100% + 32px)}.pp{margin-left:-16px}.pq{margin-right:-16px}.qh{padding-left:16px}.qi{padding-right:16px}.qj{flex-basis:33.333333%}.qk{max-width:33.333333%}.qv{align-items:flex-start}.qw{flex-direction:row}.rd{flex-basis:100%}.re{max-width:100%}.sq{padding-left:64px}.sr{padding-right:64px}.ss{max-width:1320px}</style><style type="text/css" data-fela-rehydration="533" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.gm{margin-left:30px}.sn{padding-left:64px}.so{padding-right:64px}.sp{max-width:1080px}</style><style type="text/css" data-fela-rehydration="533" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.gl{margin-left:30px}.oy{margin-bottom:0px}.qm{margin-bottom:48px}.rm{display:block}.sk{padding-left:48px}.sl{padding-right:48px}.sm{max-width:904px}</style><style type="text/css" data-fela-rehydration="533" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.ak{height:56px}.al{display:flex}.bp{display:block}.cy{margin-bottom:0px}.cz{height:110px}.eo{margin-top:32px}.ep{flex-direction:column-reverse}.gj{margin-bottom:30px}.gk{margin-left:0px}.kk{padding:10px 12px 10px}.ob{margin-bottom:24px}.oc{align-items:center}.od{width:102px}.oe{position:relative}.oh{padding-left:0}.op{margin-top:24px}.sd{padding:32px 0}.sh{padding-left:24px}.si{padding-right:24px}.sj{max-width:728px}.tn{width:140px}</style><style type="text/css" data-fela-rehydration="533" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.z{margin:0 24px}.dv{font-size:30px}.dw{margin-top:0.72em}.eg{line-height:40px}.en{margin-top:32px}.fd{margin-bottom:0px}.gh{margin-bottom:30px}.gi{margin-left:0px}.gw{font-size:18px}.gx{margin-top:1.56em}.hs{margin-top:40px}.ie{margin-top:1.41em}.il{margin-top:1.2em}.iu{margin-top:0.67em}.jq{font-size:24px}.jr{margin-top:1.23em}.kb{margin-top:24px}.pc{width:calc(100% + 24px)}.pd{margin-left:-12px}.pe{margin-right:-12px}.pr{padding-left:12px}.ps{padding-right:12px}.pt{flex-basis:100%}.pu{max-width:100%}.qn{align-items:flex-start}.qo{flex-direction:row}.rg{display:block}.ri{margin-bottom:16px}.se{padding-left:24px}.sf{padding-right:24px}.sg{max-width:552px}</style><style type="text/css" data-fela-rehydration="533" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.ae{margin:0 64px}.eb{font-size:40px}.ec{margin-top:0.78em}.ej{line-height:48px}.hc{font-size:21px}.hd{margin-top:2em}.hv{margin-top:56px}.ih{margin-top:1.91em}.ip{font-size:34px}.iq{margin-top:1.95em}.ix{margin-top:0.86em}.jw{font-size:26px}.jx{margin-top:1.72em}.ke{margin-top:32px}.pl{width:calc(100% + 32px)}.pm{margin-left:-16px}.pn{margin-right:-16px}.qd{padding-left:16px}.qe{padding-right:16px}.qf{flex-basis:33.333333%}.qg{max-width:33.333333%}.qt{align-items:flex-start}.qu{flex-direction:row}.rb{flex-basis:100%}.rc{max-width:100%}</style><style type="text/css" data-fela-rehydration="533" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.ac{margin:0 48px}.dz{font-size:40px}.ea{margin-top:0.78em}.ei{line-height:48px}.ha{font-size:21px}.hb{margin-top:2em}.hu{margin-top:56px}.ig{margin-top:1.91em}.in{font-size:34px}.io{margin-top:1.95em}.iw{margin-top:0.86em}.ju{font-size:26px}.jv{margin-top:1.72em}.kd{margin-top:32px}.pi{width:calc(100% + 28px)}.pj{margin-left:-14px}.pk{margin-right:-14px}.pz{padding-left:14px}.qa{padding-right:14px}.qb{flex-basis:100%}.qc{max-width:100%}.qr{align-items:center}.qs{flex-direction:row-reverse}.qz{flex-basis:50%}.ra{max-width:50%}</style><style type="text/css" data-fela-rehydration="533" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.ab{margin:0 24px}.dx{font-size:30px}.dy{margin-top:0.72em}.eh{line-height:40px}.gy{font-size:18px}.gz{margin-top:1.56em}.ht{margin-top:40px}.if{margin-top:1.41em}.im{margin-top:1.2em}.iv{margin-top:0.67em}.js{font-size:24px}.jt{margin-top:1.23em}.kc{margin-top:24px}.pf{width:calc(100% + 24px)}.pg{margin-left:-12px}.ph{margin-right:-12px}.pv{padding-left:12px}.pw{padding-right:12px}.px{flex-basis:100%}.py{max-width:100%}.qp{align-items:center}.qq{flex-direction:row-reverse}.qx{flex-basis:50%}.qy{max-width:50%}</style><style type="text/css" data-fela-rehydration="533" data-fela-type="RULE" media="print">.y{display:none}</style><style type="text/css" data-fela-rehydration="533" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.ls{transition:opacity 200ms}.ng{transition:border-color 150ms ease}.nh::before{background:
      radial-gradient(circle, rgba(90, 118, 144, 1) 60%, transparent 70%)
    }.ni::before{border-radius:50%}.nj::before{content:""}.nk::before{display:block}.nl::before{z-index:0}.nm::before{left:0}.nn::before{height:100%}.no::before{position:absolute}.np::before{top:0}.nq::before{width:100%}.nr:hover::before{animation:k1 2000ms infinite cubic-bezier(.1,.12,.25,1)}.nu{transition:fill 200ms ease}</style><style type="text/css" data-fela-rehydration="533" data-fela-type="RULE" media="all and (max-width: 1230px)">.lt{display:none}</style><style type="text/css" data-fela-rehydration="533" data-fela-type="RULE" media="all and (max-width: 1198px)">.lv{display:none}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><script>window.PARSELY = window.PARSELY || {autotrack: false}</script><nav class="r s t u v c w x y"><div><div class="r c"><div class="n p"><div class="z ab ac ae af ag ah ai"><div class="aj n o ak al"><div class="n o am w"><a href="https://medium.com/?source=post_page-----be532be3910e----------------------" aria-label="Homepage" rel="noopener"><svg width="35" height="35" viewBox="5 5 35 35" class="q"><path d="M5 40V5h35v35H5zm8.56-12.63c0 .56-.03.69-.32 1.03L10.8 31.4v.4h6.97v-.4L15.3 28.4c-.29-.34-.34-.5-.34-1.03v-8.95l6.13 13.36h.71l5.26-13.36v10.64c0 .3 0 .35-.19.53l-1.85 1.8v.4h9.2v-.4l-1.83-1.8c-.18-.18-.2-.24-.2-.53V15.94c0-.3.02-.35.2-.53l1.82-1.8v-.4h-6.47l-4.62 11.55-5.2-11.54h-6.8v.4l2.15 2.63c.24.3.29.37.29.77v10.35z"></path></svg></a></div><div class="r an w"><div class="n o"><div class="n g"><div class="ao" id="lo-post-page-navbar-sign-in-link"><div class="ap r"><span class="aq b ar as at au r av aw"><a href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-custom-openai-gym-environment-for-stock-trading-be532be3910e&amp;source=post_page-----be532be3910e---------------------nav_reg-" class="ax ay az ba bb bc bd be bf bg bh bi bj bk bl bm" rel="noopener">Sign in</a></span></div></div></div></div></div></div></div></div></div><div class="bn r bo bp"><div class="n p"><div class="z ab ac ae af ag ah ai"><div class="bq br n o"><div class="bs r an"><a href="https://towardsdatascience.com/?source=post_page-----be532be3910e----------------------" rel="noopener"><div class="bt bu r"><img alt="Towards Data Science" class="" src="https://miro.medium.com/max/200/1*mG6i4Bh_LgixUYXJgQpYsg@2x.png" width="100" height="36"/></div></a></div><div class="bv r bw"><ul class="bx bf by bz ca n cb g cc cd ce"><li class="n o cf cg ch ci"><span class="aq cl cm as cn co cp"><a href="https://towardsdatascience.com/data-science/home?source=post_page-----be532be3910e----------------------" class="cq cr az ba bb bc bd be bf bg cs ct bj bk cu cv" rel="noopener">Data Science</a></span></li><li class="n o cf cg ch ci"><span class="aq cl cm as cn co cp"><a href="https://towardsdatascience.com/machine-learning/home?source=post_page-----be532be3910e----------------------" class="cq cr az ba bb bc bd be bf bg cs ct bj bk cu cv" rel="noopener">Machine Learning</a></span></li><li class="n o cf cg ch ci"><span class="aq cl cm as cn co cp"><a href="https://towardsdatascience.com/programming/home?source=post_page-----be532be3910e----------------------" class="cq cr az ba bb bc bd be bf bg cs ct bj bk cu cv" rel="noopener">Programming</a></span></li><li class="n o cf cg ch ci"><span class="aq cl cm as cn co cp"><a href="https://towardsdatascience.com/data-visualization/home?source=post_page-----be532be3910e----------------------" class="cq cr az ba bb bc bd be bf bg cs ct bj bk cu cv" rel="noopener">Visualization</a></span></li><li class="n o cf cg ch ci"><span class="aq cl cm as cn co cp"><a href="https://towardsdatascience.com/artificial-intelligence/home?source=post_page-----be532be3910e----------------------" class="cq cr az ba bb bc bd be bf bg cs ct bj bk cu cv" rel="noopener">AI</a></span></li><li class="n o cf cg ch ci"><span class="aq cl cm as cn co cp"><a href="https://towardsdatascience.com/our-picks/home?source=post_page-----be532be3910e----------------------" class="cq cr az ba bb bc bd be bf bg cs ct bj bk cu cv" rel="noopener">Picks</a></span></li><li class="n o cf cg ch ci"><span class="aq cl cm as cn co cp"><a href="https://towardsdatascience.com/more/home?source=post_page-----be532be3910e----------------------" class="cq cr az ba bb bc bd be bf bg cs ct bj bk cu cv" rel="noopener">More</a></span></li><span class="cf cj ck"></span><li class="n o cf cg ch ci"><span class="aq cl cm as cn co cp"><a href="https://towardsdatascience.com/contribute/home?source=post_page-----be532be3910e----------------------" class="cq cr az ba bb bc bd be bf bg cs ct bj bk cu cv" rel="noopener">Contribute</a></span></li></ul></div></div></div></div></div></div></nav><div class="cw cx r cy cz"></div><article class="meteredContent"><section class="da db dc dd ai de df n dg"></section><span class="r"></span><div><div class="s u dh di dj dk"></div><section class="dl dm dn do dp"><div class="n p"><div class="z ab ac ae af dq ah ai"><div><div id="501f" class="dr ds dt ar du b dv dw dx dy dz ea eb ec ed ee ef"><h1 class="du b dv eg dx eh dz ei eb ej ed ek dt">Create custom gym environments from scratch — A stock market example</h1></div><div class="el"><div class="n em en eo ep"><div class="o n"><div><a href="/@notadamking?source=post_page-----be532be3910e----------------------" rel="noopener"><div class="eq er es"><div class="et n eu o p s ev ew ex ey ez dk"><svg width="57" height="57" viewBox="0 0 57 57"><path fill-rule="evenodd" clip-rule="evenodd" d="M28.5 1.2A27.45 27.45 0 0 0 4.06 15.82L3 15.27A28.65 28.65 0 0 1 28.5 0C39.64 0 49.29 6.2 54 15.27l-1.06.55A27.45 27.45 0 0 0 28.5 1.2zM4.06 41.18A27.45 27.45 0 0 0 28.5 55.8a27.45 27.45 0 0 0 24.44-14.62l1.06.55A28.65 28.65 0 0 1 28.5 57 28.65 28.65 0 0 1 3 41.73l1.06-.55z"></path></svg></div><img alt="Adam King" class="r fa es er" src="https://miro.medium.com/fit/c/96/96/2*GnXdYdgLDvWhInOVFHxikA.jpeg" width="48" height="48"/></div></a></div><div class="fb ai r"><div class="n"><div style="flex:1"><span class="aq b ar as at au r dt q"><div class="fc n o fd"><span class="aq cl fe as br ff fg fh fi fj dt"><a href="/@notadamking?source=post_page-----be532be3910e----------------------" class="cq cr az ba bb bc bd be bf bg fk bj bk fl fm" rel="noopener">Adam King</a></span><div class="fn r an h"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-custom-openai-gym-environment-for-stock-trading-be532be3910e&amp;source=-6e3a5234f1cc-------------------------follow_byline-" class="fo dt q fp fq fr fs ft bg fl fu fv fw fx fy fz ga aq b ar gb cm au gc gd df ge gf bj" rel="noopener">Follow</a></div></div></span></div></div><span class="aq b ar as at au r av aw"><span class="aq cl fe as br ff fg fh fi fj av"><div><a class="cq cr az ba bb bc bd be bf bg fk bj bk fl fm" rel="noopener" href="/creating-a-custom-openai-gym-environment-for-stock-trading-be532be3910e?source=post_page-----be532be3910e----------------------">Apr 10, 2019</a> <!-- -->·<!-- --> <!-- -->8<!-- --> min read<span style="padding-left:4px"><svg class="star-15px_svg__svgIcon-use" width="15" height="15" viewBox="0 0 15 15" style="margin-top:-2px"><path d="M7.44 2.32c.03-.1.09-.1.12 0l1.2 3.53a.29.29 0 0 0 .26.2h3.88c.11 0 .13.04.04.1L9.8 8.33a.27.27 0 0 0-.1.29l1.2 3.53c.03.1-.01.13-.1.07l-3.14-2.18a.3.3 0 0 0-.32 0L4.2 12.22c-.1.06-.14.03-.1-.07l1.2-3.53a.27.27 0 0 0-.1-.3L2.06 6.16c-.1-.06-.07-.12.03-.12h3.89a.29.29 0 0 0 .26-.19l1.2-3.52z"></path></svg></span></div></span></span></div></div><div class="n gg gh gi gj gk gl gm gn y"><div class="n o"><div class="go r an"><a href="//medium.com/p/be532be3910e/share/twitter?source=post_actions_header---------------------------" class="cq cr az ba bb bc bd be bf bg gp gq bj bk fl fm" target="_blank" rel="noopener nofollow"><svg width="29" height="29" class="q"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></a></div><div class="go r an"><button class="cq cr az ba bb bc bd be bf bg gp gq bj bk fl fm"><svg width="29" height="29" viewBox="0 0 29 29" fill="none" class="q"><path d="M5 6.36C5 5.61 5.63 5 6.4 5h16.2c.77 0 1.4.61 1.4 1.36v16.28c0 .75-.63 1.36-1.4 1.36H6.4c-.77 0-1.4-.6-1.4-1.36V6.36z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M10.76 20.9v-8.57H7.89v8.58h2.87zm-1.44-9.75c1 0 1.63-.65 1.63-1.48-.02-.84-.62-1.48-1.6-1.48-.99 0-1.63.64-1.63 1.48 0 .83.62 1.48 1.59 1.48h.01zM12.35 20.9h2.87v-4.79c0-.25.02-.5.1-.7.2-.5.67-1.04 1.46-1.04 1.04 0 1.46.8 1.46 1.95v4.59h2.87v-4.92c0-2.64-1.42-3.87-3.3-3.87-1.55 0-2.23.86-2.61 1.45h.02v-1.24h-2.87c.04.8 0 8.58 0 8.58z" fill="#fff"></path></svg></button></div><div class="go r an"><a href="//medium.com/p/be532be3910e/share/facebook?source=post_actions_header---------------------------" class="cq cr az ba bb bc bd be bf bg gp gq bj bk fl fm" target="_blank" rel="noopener nofollow"><svg width="29" height="29" class="q"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></a></div><div class="gr r"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-custom-openai-gym-environment-for-stock-trading-be532be3910e&amp;source=post_actions_header--------------------------bookmark_sidebar-" class="cq cr az ba bb bc bd be bf bg gp gq bj bk fl fm" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></div><div class="gs r am"></div></div></div></div></div></div><p id="2d07" class="gt gu dt ar gv b gw gx gy gz ha hb hc hd he hf hg dl">OpenAI’s <code class="hh hi hj hk hl b">gym</code> is an awesome package that allows you to create custom reinforcement learning agents. It comes with quite a few pre-built environments like <a href="https://gym.openai.com/envs/#classic_control" class="cq gf hm hn ho hp" target="_blank" rel="noopener nofollow">CartPole</a>, <a href="https://gym.openai.com/envs/#classic_control" class="cq gf hm hn ho hp" target="_blank" rel="noopener nofollow">MountainCar</a>, and <a href="https://gym.openai.com/envs/#atari" class="cq gf hm hn ho hp" target="_blank" rel="noopener nofollow">a ton of free Atari games</a> to experiment with.</p><p id="2c85" class="gt gu dt ar gv b gw gx gy gz ha hb hc hd he hf hg dl">These environments are great for learning, but eventually you’ll want to setup an agent to solve a custom problem. To do this, you’ll need to create a custom environment, specific to your problem domain. Later, we will create a custom stock market environment for simulating stock trades. All of the code for this article will be available on my <a href="https://github.com/notadamking/Stock-Trading-Environment" class="cq gf hm hn ho hp" target="_blank" rel="noopener nofollow"><strong class="gv hq">GitHub</strong></a>.</p><p id="5d19" class="gt gu dt ar gv b gw gx gy gz ha hb hc hd he hf hg dl">First, let’s learn about what exactly an environment is. An environment contains all the necessary functionality to run an agent and allow it to learn. Each environment must implement the following <em class="hr">gym</em> interface:</p><pre class="hs ht hu hv hw hx hy ca"><span id="1d16" class="hz ia dt ar hl b fe ib ic r id"><strong class="hl hq">import</strong> gym<br/><strong class="hl hq">from</strong> gym <strong class="hl hq">import</strong> spaces<br/><br/><strong class="hl hq">class</strong> <strong class="hl hq">CustomEnv</strong>(gym.Env):<br/>  <em class="hr">&quot;&quot;&quot;Custom Environment that follows gym interface&quot;&quot;&quot;</em><br/>  metadata = {&#x27;render.modes&#x27;: [&#x27;human&#x27;]}<br/><br/>  <strong class="hl hq">def</strong> __init__(self, arg1, arg2, ...):<br/>    super(CustomEnv, self).__init__()</span><span id="a1b2" class="hz ia dt ar hl b fe ie if ig ih ii ic r id">    <em class="hr"># Define action and observation space</em><br/>    <em class="hr"># They must be gym.spaces objects</em></span><span id="f3bb" class="hz ia dt ar hl b fe ie if ig ih ii ic r id">    <em class="hr"># Example when using discrete actions:</em><br/>    self.action_space = spaces.Discrete(N_DISCRETE_ACTIONS)</span><span id="3019" class="hz ia dt ar hl b fe ie if ig ih ii ic r id"><em class="hr">    # Example for using image as input:</em><br/>    self.observation_space = spaces.Box(low=0, high=255, shape=<br/>                    (HEIGHT, WIDTH, N_CHANNELS), dtype=np.uint8)<br/><br/>  <strong class="hl hq">def</strong> step(self, action):<br/>    # Execute one time step within the environment<br/>    ...</span><span id="a5b4" class="hz ia dt ar hl b fe ie if ig ih ii ic r id">  <strong class="hl hq">def</strong> reset(self):<br/>    # Reset the state of the environment to an initial state<br/>    ...</span><span id="1601" class="hz ia dt ar hl b fe ie if ig ih ii ic r id">  <strong class="hl hq">def</strong> render(self, mode=&#x27;human&#x27;, close=False):<br/>    # Render the environment to the screen<br/>    ...</span></pre><p id="7622" class="gt gu dt ar gv b gw gx gy gz ha hb hc hd he hf hg dl">In the constructor, we first define the type and shape of our <code class="hh hi hj hk hl b">action_space</code>, which will contain all of the actions possible for an agent to take in the environment. Similarly, we’ll define the <code class="hh hi hj hk hl b">observation_space</code>, which contains all of the environment’s data to be observed by the agent.</p><p id="1814" class="gt gu dt ar gv b gw gx gy gz ha hb hc hd he hf hg dl">Our <code class="hh hi hj hk hl b">reset</code> method will be called to periodically reset the environment to an initial state. This is followed by many <code class="hh hi hj hk hl b">step</code>s through the environment, in which an action will be provided by the model and must be executed, and the next observation returned. This is also where rewards are calculated, more on this later.</p><p id="00bc" class="gt gu dt ar gv b gw gx gy gz ha hb hc hd he hf hg dl">Finally, the <code class="hh hi hj hk hl b">render</code> method may be called periodically to print a rendition of the environment. This could be as simple as a print statement, or as complicated as rendering a 3D environment using openGL. For this example, we will stick with print statements.</p><h1 id="f647" class="ij ia dt ar aq ik dv il dx im in io ip iq ir is it"><strong class="bd">Stock Trading Environment</strong></h1><p id="4836" class="gt gu dt ar gv b gw iu gy iv ha iw hc ix he iy hg dl">To demonstrate how this all works, we are going to create a stock trading environment. We will then train our agent to become a profitable trader within the environment. Let’s get started!</p><figure class="hs ht hu hv hw ja dc dd paragraph-image"><div class="jb jc eq jd ai"><div class="dc dd iz"><div class="jj r eq hh"><div class="jk r"><div class="je jf s t u jg ai br jh ji"><img class="s t u jg ai jl jm jn" src="https://miro.medium.com/max/60/1*3UNtfZrmEiv3XFKs_xaRcA.jpeg?q=20" width="4608" height="3456" role="presentation"/></div><img class="je jf s t u jg ai jo" width="4608" height="3456" role="presentation"/><noscript><img class="s t u jg ai" src="https://miro.medium.com/max/9216/1*3UNtfZrmEiv3XFKs_xaRcA.jpeg" width="4608" height="3456" role="presentation"/></noscript></div></div></div></div></figure><p id="ad8b" class="gt gu dt ar gv b gw gx gy gz ha hb hc hd he hf hg dl">The first thing we’ll need to consider is how a human trader would perceive their environment. What observations would they make before deciding to make a trade?</p><p id="16bf" class="gt gu dt ar gv b gw gx gy gz ha hb hc hd he hf hg dl">A trader would most likely look at some charts of a stock’s price action, perhaps overlaid with a couple technical indicators. From there, they would combine this visual information with their prior knowledge of similar price action to make an informed decision of which direction the stock is likely to move.</p><p id="bfd7" class="gt gu dt ar gv b gw gx gy gz ha hb hc hd he hf hg dl">So let’s translate this into how our agent should perceive its environment.</p><p id="cafe" class="gt gu dt ar gv b gw gx gy gz ha hb hc hd he hf hg dl">Our <code class="hh hi hj hk hl b">observation_space</code> contains all of the input variables we want our agent to consider before making, <em class="hr">or not making</em> a trade. In this example, we want our agent to “see” the stock data points (open price, high, low, close, and daily volume) for the last five days, as well a couple other data points like its account balance, current stock positions, and current profit.</p><p id="b82b" class="gt gu dt ar gv b gw gx gy gz ha hb hc hd he hf hg dl">The intuition here is that for each time step, we want our agent to consider the price action leading up to the current price, as well as their own portfolio’s status in order to make an informed decision for the next action.</p><p id="5387" class="gt gu dt ar gv b gw gx gy gz ha hb hc hd he hf hg dl">Once a trader has perceived their environment, they need to take an action. In our agent’s case, its <code class="hh hi hj hk hl b">action_space</code> will consist of three possibilities: buy a stock, sell a stock, or do nothing.</p><p id="142d" class="gt gu dt ar gv b gw gx gy gz ha hb hc hd he hf hg dl">But this isn’t enough; we need to know the amount of a given stock to buy or sell each time. Using gym’s <code class="hh hi hj hk hl b">Box</code> space, we can create an action space that has a discrete number of action types (buy, sell, and hold), as well as a continuous spectrum of amounts to buy/sell (0-100% of the account balance/position size respectively).</p><p id="c783" class="gt gu dt ar gv b gw gx gy gz ha hb hc hd he hf hg dl">You’ll notice the amount is not necessary for the hold action, but will be provided anyway. Our agent does not initially know this, but over time should learn that the amount is extraneous for this action.</p><p id="8094" class="gt gu dt ar gv b gw gx gy gz ha hb hc hd he hf hg dl">The last thing to consider before implementing our environment is the reward. We want to incentivize profit that is sustained over long periods of time. At each step, we will set the reward to the account balance multiplied by some fraction of the number of time steps so far.</p><p id="c2e3" class="gt gu dt ar gv b gw gx gy gz ha hb hc hd he hf hg dl">The purpose of this is to delay rewarding the agent too fast in the early stages and allow it to explore sufficiently before optimizing a single strategy too deeply. It will also reward agents that maintain a higher balance for longer, rather than those who rapidly gain money using unsustainable strategies.</p><figure class="hs ht hu hv hw ja"><div class="jj r eq"><div class="jp r"><iframe src="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fupscri.be%2F6b7140%3Fas_embed%3Dtrue&amp;dntp=1&amp;url=https%3A%2F%2Fupscri.be%2F6b7140%2F&amp;image=http%3A%2F%2Fapi.screenshotlayer.com%2Fapi%2Fcapture%3Faccess_key%3Dfe59908dad3baab69ffab249a2224b03%26viewport%3D1024x612%26width%3D1000%26url%3Dhttps%253A%252F%252Fupscri.be%252F6b7140%253Fscreenshot&amp;key=a19fcc184b9711e1b4764040d3dc5c07&amp;type=text%2Fhtml&amp;schema=upscri" allowfullscreen="" frameBorder="0" height="400" width="800" title="Want to be notified every time I post?" class="s t u jg ai" scrolling="auto"></iframe></div></div></figure><h2 id="8430" class="hz ia dt ar aq ik jq jr js jt ju jv jw jx jy jz ka">Implementation</h2><p id="a8a9" class="gt gu dt ar gv b gw iu gy iv ha iw hc ix he iy hg dl">Now that we’ve defined our observation space, action space, and rewards, it’s time to implement our environment. First, we need define the <code class="hh hi hj hk hl b">action_space</code> and <code class="hh hi hj hk hl b">observation_space</code> in the environment’s constructor. The environment expects a <code class="hh hi hj hk hl b">pandas</code> data frame to be passed in containing the stock data to be learned from. An example is provided in the <a href="https://github.com/adamjking3/Stock-Trading-Environment" class="cq gf hm hn ho hp" target="_blank" rel="noopener nofollow"><strong class="gv hq">Github repo</strong></a>.</p><pre class="hs ht hu hv hw hx hy ca"><span id="aa16" class="hz ia dt ar hl b fe ib ic r id"><strong class="hl hq"><em class="hr">class</em></strong> <strong class="hl hq">StockTradingEnvironment</strong>(<em class="hr">gym</em>.<em class="hr">Env</em>):<br/>  &quot;&quot;&quot;A stock trading environment for OpenAI gym&quot;&quot;&quot;<br/>  metadata = {&#x27;render.modes&#x27;: [&#x27;human&#x27;]}</span><span id="abbf" class="hz ia dt ar hl b fe ie if ig ih ii ic r id"><strong class="hl hq">  def </strong>__init__(<em class="hr">self, df</em>):<br/>    <em class="hr">super</em>(StockTradingEnv, self).__init__()<br/>    self.df = df<br/>    self.reward_range = (0, MAX_ACCOUNT_BALANCE) </span><span id="dfd1" class="hz ia dt ar hl b fe ie if ig ih ii ic r id">    # Actions of the format Buy x%, Sell x%, Hold, etc.<br/>    self.action_space = spaces.Box(<br/>      <em class="hr">low</em>=np.array([0, 0]), <em class="hr">high</em>=np.array([3, 1]), <em class="hr">dtype</em>=np.float16)</span><span id="8d7c" class="hz ia dt ar hl b fe ie if ig ih ii ic r id">    # Prices contains the OHCL values for the last five prices<br/>    self.observation_space = spaces.Box(<br/>      <em class="hr">low</em>=0, <em class="hr">high</em>=1, <em class="hr">shape</em>=(6, 6), <em class="hr">dtype</em>=np.float16)</span></pre><p id="d782" class="gt gu dt ar gv b gw gx gy gz ha hb hc hd he hf hg dl">Next, we’ll write the <code class="hh hi hj hk hl b">reset</code> method, which is called any time a new environment is created or to reset an existing environment’s state. It’s here where we’ll set the starting balance of each agent and initialize its open positions to an empty list.</p><pre class="hs ht hu hv hw hx hy ca"><span id="f9bd" class="hz ia dt ar hl b fe ib ic r id"><strong class="hl hq">def </strong>reset(<em class="hr">self</em>):<br/>  # Reset the state of the environment to an initial state<br/>  self.balance = INITIAL_ACCOUNT_BALANCE<br/>  self.net_worth = INITIAL_ACCOUNT_BALANCE<br/>  self.max_net_worth = INITIAL_ACCOUNT_BALANCE<br/>  self.shares_held = 0<br/>  self.cost_basis = 0<br/>  self.total_shares_sold = 0<br/>  self.total_sales_value = 0<br/> <br/>  # Set the current step to a random point within the data frame<br/>  self.current_step = random.randint(0, len(self.df.loc[:, &#x27;Open&#x27;].values) - 6)</span><span id="9151" class="hz ia dt ar hl b fe ie if ig ih ii ic r id">  <strong class="hl hq">return</strong> self._next_observation()</span></pre><p id="e33c" class="gt gu dt ar gv b gw gx gy gz ha hb hc hd he hf hg dl">We set the current step to a random point within the data frame, because it essentially gives our agent’s more unique experiences from the same data set. The <code class="hh hi hj hk hl b">_next_observation</code> method compiles the stock data for the last five time steps, appends the agent’s account information, and scales all the values to between 0 and 1.</p><pre class="hs ht hu hv hw hx hy ca"><span id="a801" class="hz ia dt ar hl b fe ib ic r id"><strong class="hl hq"><em class="hr">def</em></strong> _next_observation(<em class="hr">self</em>):<br/>  # Get the data points for the last 5 days and scale to between 0-1<br/>  frame = np.array([<br/>    self.df.loc[self.current_step: self.current_step +<br/>                5, &#x27;Open&#x27;].values / MAX_SHARE_PRICE,<br/>    self.df.loc[self.current_step: self.current_step +<br/>                5, &#x27;High&#x27;].values / MAX_SHARE_PRICE,<br/>    self.df.loc[self.current_step: self.current_step +<br/>                5, &#x27;Low&#x27;].values / MAX_SHARE_PRICE,<br/>    self.df.loc[self.current_step: self.current_step +<br/>                5, &#x27;Close&#x27;].values / MAX_SHARE_PRICE,<br/>    self.df.loc[self.current_step: self.current_step +<br/>                5, &#x27;Volume&#x27;].values / MAX_NUM_SHARES,<br/>   ])</span><span id="7e4c" class="hz ia dt ar hl b fe ie if ig ih ii ic r id">  # Append additional data and scale each value to between 0-1<br/>  obs = np.append(frame, [[<br/>    self.balance / MAX_ACCOUNT_BALANCE,<br/>    self.max_net_worth / MAX_ACCOUNT_BALANCE,<br/>    self.shares_held / MAX_NUM_SHARES,<br/>    self.cost_basis / MAX_SHARE_PRICE,<br/>    self.total_shares_sold / MAX_NUM_SHARES,<br/>    self.total_sales_value / (MAX_NUM_SHARES * MAX_SHARE_PRICE),<br/>  ]], <em class="hr">axis</em>=0)</span><span id="1050" class="hz ia dt ar hl b fe ie if ig ih ii ic r id">  <strong class="hl hq">return</strong> obs</span></pre><p id="1465" class="gt gu dt ar gv b gw gx gy gz ha hb hc hd he hf hg dl">Next, our environment needs to be able to take a <code class="hh hi hj hk hl b">step</code>. At each step we will take the specified action (chosen by our model), calculate the reward, and return the next observation.</p><pre class="hs ht hu hv hw hx hy ca"><span id="937f" class="hz ia dt ar hl b fe ib ic r id"><strong class="hl hq"><em class="hr">def</em></strong> step(<em class="hr">self</em>, <em class="hr">action</em>):<br/>  # Execute one time step within the environment<br/>  self._take_action(action)</span><span id="550b" class="hz ia dt ar hl b fe ie if ig ih ii ic r id">  self.current_step += 1</span><span id="5a5a" class="hz ia dt ar hl b fe ie if ig ih ii ic r id">  <strong class="hl hq">if</strong> self.current_step &gt; len(self.df.loc[:, &#x27;Open&#x27;].values) - 6:<br/>    self.current_step = 0</span><span id="4b9e" class="hz ia dt ar hl b fe ie if ig ih ii ic r id">  delay_modifier = (self.current_step / MAX_STEPS)<br/>  <br/>  reward = self.balance * delay_modifier<br/>  done = self.net_worth &lt;= 0</span><span id="91a8" class="hz ia dt ar hl b fe ie if ig ih ii ic r id">  obs = self._next_observation()</span><span id="8463" class="hz ia dt ar hl b fe ie if ig ih ii ic r id">  <strong class="hl hq">return</strong> obs, reward, done, {}</span></pre><p id="bec8" class="gt gu dt ar gv b gw gx gy gz ha hb hc hd he hf hg dl">Now, our <code class="hh hi hj hk hl b">_take_action</code> method needs to take the action provided by the model and either buy, sell, or hold the stock.</p><pre class="hs ht hu hv hw hx hy ca"><span id="0f28" class="hz ia dt ar hl b fe ib ic r id"><strong class="hl hq"><em class="hr">def</em></strong> _take_action(<em class="hr">self</em>, <em class="hr">action</em>):<br/>  # Set the current price to a random price within the time step<br/>  current_price = random.uniform(<br/>    self.df.loc[self.current_step, &quot;Open&quot;],<br/>    self.df.loc[self.current_step, &quot;Close&quot;])</span><span id="5ccd" class="hz ia dt ar hl b fe ie if ig ih ii ic r id">  action_type = action[0]<br/>  amount = action[1]</span><span id="6ee5" class="hz ia dt ar hl b fe ie if ig ih ii ic r id"><strong class="hl hq">  if</strong> action_type &lt; 1:<br/>    # Buy amount % of balance in shares<br/>    total_possible = self.balance / current_price<br/>    shares_bought = total_possible * amount<br/>    prev_cost = self.cost_basis * self.shares_held<br/>    additional_cost = shares_bought * current_price</span><span id="d0d4" class="hz ia dt ar hl b fe ie if ig ih ii ic r id">    self.balance -= additional_cost<br/>    self.cost_basis = (prev_cost + additional_cost) / <br/>                            (self.shares_held + shares_bought)<br/>    self.shares_held += shares_bought</span><span id="247d" class="hz ia dt ar hl b fe ie if ig ih ii ic r id">  <strong class="hl hq">elif</strong> actionType &lt; 2:<br/>    # Sell amount % of shares held<br/>    shares_sold = self.shares_held * amount . <br/>    self.balance += shares_sold * current_price<br/>    self.shares_held -= shares_sold<br/>    self.total_shares_sold += shares_sold<br/>    self.total_sales_value += shares_sold * current_price</span><span id="a65b" class="hz ia dt ar hl b fe ie if ig ih ii ic r id">  self.netWorth = self.balance + self.shares_held * current_price</span><span id="210a" class="hz ia dt ar hl b fe ie if ig ih ii ic r id">  <strong class="hl hq">if</strong> self.net_worth &gt; self.max_net_worth:<br/>    self.max_net_worth = net_worth</span><span id="6fbe" class="hz ia dt ar hl b fe ie if ig ih ii ic r id">  <strong class="hl hq">if</strong> self.shares_held == 0:<br/>    self.cost_basis = 0</span></pre><p id="58f4" class="gt gu dt ar gv b gw gx gy gz ha hb hc hd he hf hg dl">The only thing left to do now is <code class="hh hi hj hk hl b">render</code> the environment to the screen. For simplicity’s sake, we will just render the profit made so far and a couple other interesting metrics.</p><pre class="hs ht hu hv hw hx hy ca"><span id="095d" class="hz ia dt ar hl b fe ib ic r id"><strong class="hl hq"><em class="hr">def</em></strong> render(<em class="hr">self</em>, <em class="hr">mode</em>=&#x27;human&#x27;, <em class="hr">close</em>=False):<br/>  # Render the environment to the screen<br/>  profit = self.net_worth - INITIAL_ACCOUNT_BALANCE</span><span id="c1b1" class="hz ia dt ar hl b fe ie if ig ih ii ic r id">  print(<em class="hr">f</em>&#x27;Step: {self.current_step}&#x27;)<br/>  print(<em class="hr">f</em>&#x27;Balance: {self.balance}&#x27;)<br/>  print(<em class="hr">f</em>&#x27;Shares held: {self.shares_held}<br/>          (Total sold: {self.total_shares_sold})&#x27;)<br/>  print(<em class="hr">f</em>&#x27;Avg cost for held shares: {self.cost_basis}<br/>          (Total sales value: {self.total_sales_value})&#x27;)<br/>  print(<em class="hr">f</em>&#x27;Net worth: {self.net_worth}<br/>          (Max net worth: {self.max_net_worth})&#x27;)<br/>  print(<em class="hr">f</em>&#x27;Profit: {profit}&#x27;)</span></pre><p id="647d" class="gt gu dt ar gv b gw gx gy gz ha hb hc hd he hf hg dl">Our environment is complete. We can now instantiate a <code class="hh hi hj hk hl b">StockTradingEnv</code> environment with a data frame and test it with a model from <a href="https://github.com/hill-a/stable-baselines" class="cq gf hm hn ho hp" target="_blank" rel="noopener nofollow">stable-baselines</a>.</p><pre class="hs ht hu hv hw hx hy ca"><span id="448e" class="hz ia dt ar hl b fe ib ic r id"><strong class="hl hq">import</strong> gym<br/><strong class="hl hq">import</strong> json<br/><strong class="hl hq">import</strong> datetime <strong class="hl hq">as</strong> dt</span><span id="7e33" class="hz ia dt ar hl b fe ie if ig ih ii ic r id"><strong class="hl hq">from</strong> stable_baselines.common.policies <strong class="hl hq">import</strong> MlpPolicy<br/><strong class="hl hq">from</strong> stable_baselines.common.vec_env <strong class="hl hq">import</strong> DummyVecEnv<br/><strong class="hl hq">from</strong> stable_baselines <strong class="hl hq">import</strong> PPO2</span><span id="f349" class="hz ia dt ar hl b fe ie if ig ih ii ic r id"><strong class="hl hq">from</strong> env.StockTradingEnv <strong class="hl hq">import</strong> StockTradingEnv</span><span id="7ac0" class="hz ia dt ar hl b fe ie if ig ih ii ic r id"><strong class="hl hq">import</strong> pandas <strong class="hl hq">as</strong> pd</span><span id="1acb" class="hz ia dt ar hl b fe ie if ig ih ii ic r id">df = pd.read_csv(&#x27;./data/AAPL.csv&#x27;)<br/>df = df.sort_values(&#x27;Date&#x27;)</span><span id="9acb" class="hz ia dt ar hl b fe ie if ig ih ii ic r id"># The algorithms require a vectorized environment to run<br/>env = DummyVecEnv([<em class="hr">lambda</em>: StockTradingEnv(df)])</span><span id="3605" class="hz ia dt ar hl b fe ie if ig ih ii ic r id">model = PPO2(MlpPolicy, env, <em class="hr">verbose</em>=1)<br/>model.learn(<em class="hr">total_timesteps</em>=20000)</span><span id="f5d3" class="hz ia dt ar hl b fe ie if ig ih ii ic r id">obs = env.reset()<br/><strong class="hl hq">for</strong> i <strong class="hl hq">in</strong> range(2000):<br/>  action, _states = model.predict(obs)<br/>  obs, rewards, done, info = env.step(action)<br/>  env.render()</span></pre><p id="ca7c" class="gt gu dt ar gv b gw gx gy gz ha hb hc hd he hf hg dl">Now of course, this was all just for fun to test out creating an interesting, custom gym environment with some semi-complex actions, observations, and reward spaces. It’s going to take a lot more time and effort if we really want to get rich with deep learning in the stock market…</p><p id="1ee8" class="gt gu dt ar gv b gw gx gy gz ha hb hc hd he hf hg dl">Stay tuned for next week’s article where we’ll learn to <a class="cq gf hm hn ho hp" target="_blank" rel="noopener" href="/visualizing-stock-trading-agents-using-matplotlib-and-gym-584c992bc6d4">create simple, yet elegant visualizations of our environments</a>!</p><div class="kb kc kd ke kf kg"><a target="_blank" rel="noopener" href="/creating-bitcoin-trading-bots-that-dont-lose-money-2e7165fb0b29"><div class="kh n an"><div class="ki n dg p kj kk"><h2 class="aq ik kl as br km fg fh kn fj dt">Creating Bitcoin trading bots that don’t lose money</h2><div class="ko r"><h3 class="aq cl fe as br km fg fh kn fj av">Let’s make profitable cryptocurrency trading agents using deep reinforcement learning</h3></div><div class="kp r"><h4 class="aq cl cm as br km fg fh kn fj av">towardsdatascience.com</h4></div></div><div class="kq r"><div class="kr r ks kt ku kq kv kw kx"></div></div></div></a></div></div></div></section><hr class="ky cl kz la lb lc ld le lf lg lh"/><section class="dl dm dn do dp"><div class="n p"><div class="z ab ac ae af dq ah ai"><p id="1bab" class="gt gu dt ar gv b gw gx gy gz ha hb hc hd he hf hg dl"><em class="hr">Thanks for reading! As always, all of the code for this tutorial can be found on my </em><a href="https://github.com/notadamking/Stock-Trading-Environment" class="cq gf hm hn ho hp" target="_blank" rel="noopener nofollow"><em class="hr">GitHub</em></a><em class="hr">. Leave a comment below if you have any questions or feedback, I’d love to hear from you! I can also be reached on </em><a href="https://twitter.com/notadamking" class="cq gf hm hn ho hp" target="_blank" rel="noopener nofollow"><em class="hr">Twitter</em></a><em class="hr"> at @notadamking.</em></p><p id="33fe" class="gt gu dt ar gv b gw gx gy gz ha hb hc hd he hf hg dl"><em class="hr">You can also sponsor me on </em><a href="https://github.com/users/notadamking/sponsorship" class="cq gf hm hn ho hp" target="_blank" rel="noopener nofollow"><em class="hr">Github Sponsors</em></a><em class="hr"> or </em><a href="https://www.patreon.com/join/notadamking" class="cq gf hm hn ho hp" target="_blank" rel="noopener nofollow"><em class="hr">Patreon</em></a><em class="hr"> via the links below.</em></p><div class="kb kc kd ke kf kg"><a href="https://github.com/users/notadamking/sponsorship" target="_blank" rel="noopener nofollow"><div class="kh n an"><div class="ki n dg p kj kk"><h2 class="aq ik kl as br km fg fh kn fj dt">Sponsor @notadamking on GitHub Sponsors</h2><div class="ko r"><h3 class="aq cl fe as br km fg fh kn fj av">Hi, I’m Adam. I’m a developer, writer, and entrepreneur, specifically interested in financial applications of deep…</h3></div><div class="kp r"><h4 class="aq cl cm as br km fg fh kn fj av">github.com</h4></div></div><div class="kq r"><div class="li r ks kt ku kq kv kw kx"></div></div></div></a></div><blockquote class="lj lk ll"><p id="d9fb" class="gt gu dt hr gv b gw gx gy gz ha hb hc hd he hf hg dl">Github Sponsors is currently matching all donations 1:1 up to $5,000!</p></blockquote><div class="kb kc kd ke kf kg"><a href="https://patreon.com/notadamking" target="_blank" rel="noopener nofollow"><div class="kh n an"><div class="ki n dg p kj kk"><h2 class="aq ik kl as br km fg fh kn fj dt">Adam King is creating World Changing Content | Patreon</h2><div class="ko r"><h3 class="aq cl fe as br km fg fh kn fj av">Hi, I’m Adam. I’m a developer, writer, and entrepreneur, specifically interested in financial applications of deep…</h3></div><div class="kp r"><h4 class="aq cl cm as br km fg fh kn fj av">patreon.com</h4></div></div><div class="kq r"><div class="lm r ks kt ku kq kv kw kx"></div></div></div></a></div></div></div></section></div></article><div class="je dk ln lo ai lu ls lv" data-test-id="post-sidebar"><div class="n p"><div class="z ab ac ae af ag ah ai"><div class="lw n dg"><div class="dk"><div class="lx ly r"><a href="https://towardsdatascience.com/?source=post_sidebar--------------------------post_sidebar-" class="cq cr az ba bb bc bd be bf bg gp gq bj bk fl fm" rel="noopener"><h2 class="aq ik kl as dt">Towards Data Science</h2></a><div class="lz ma r"><h4 class="aq cl fe as br mb fg fh mc fj av">A Medium publication sharing concepts, ideas, and codes.</h4></div><div class="ge" aria-hidden="true"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-custom-openai-gym-environment-for-stock-trading-be532be3910e&amp;source=post_sidebar--------------------------follow_sidebar-" class="md fp ax ay me bh bi mf bg ga aq b ar as at au gc gd df ge gf bj" rel="noopener">Follow</a></div></div><div class="mg mh mi n"><div class="n o"><div class="mj r eq"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-custom-openai-gym-environment-for-stock-trading-be532be3910e&amp;source=post_sidebar-----be532be3910e---------------------clap_sidebar-" class="cq cr az ba bb bc bd be bf bg gp gq bj bk fl fm" rel="noopener"><div class="be mk ml mm mn mo mp mq ay mr bi"><svg width="29" height="29"><g fill-rule="evenodd"><path d="M13.74 1l.76 2.97.76-2.97zM16.82 4.78l1.84-2.56-1.43-.47zM10.38 2.22l1.84 2.56-.41-3.03zM22.38 22.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M9.1 22.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L6.1 15.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L6.4 11.26l-1.18-1.18a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L11.96 14a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L8.43 9.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L20.63 15c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM13 6.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 23 23.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></div><div class="ms r"><div class="mt"><h4 class="aq cl fe as av"><button class="cq cr az ba bb bc bd be bf bg gp gq bj bk fl fm">1.4K </button></h4></div></div></div></div><div class="mh r"></div><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-custom-openai-gym-environment-for-stock-trading-be532be3910e&amp;source=post_sidebar--------------------------bookmark_sidebar-" class="cq cr az ba bb bc bd be bf bg gp gq bj bk fl fm" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></div></div></div></div></div><div class="je dk ln lo lp ey lq lr ls lt"></div><div><div class="mu ja n dg p"><div class="n p"><div class="z ab ac ae af dq ah ai"><div class="n mv"></div><div class="n o mv"></div><div class="mw r"><ul class="be bf"><li class="ge bx gr mx"><a href="/tag/machine-learning" class="my mz gf av r hy na a b cm">Machine Learning</a></li><li class="ge bx gr mx"><a href="/tag/stock-trading" class="my mz gf av r hy na a b cm">Stock Trading</a></li><li class="ge bx gr mx"><a href="/tag/deep-learning" class="my mz gf av r hy na a b cm">Deep Learning</a></li><li class="ge bx gr mx"><a href="/tag/openai-gym" class="my mz gf av r hy na a b cm">Openai Gym</a></li><li class="ge bx gr mx"><a href="/tag/stock-market" class="my mz gf av r hy na a b cm">Stock Market</a></li></ul></div><div class="nb n em y"><div class="n o"><div class="nc r eq"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-custom-openai-gym-environment-for-stock-trading-be532be3910e&amp;source=post_actions_footer-----be532be3910e---------------------clap_footer-" class="cq cr az ba bb bc bd be bf bg gp gq bj bk fl fm" rel="noopener"><div class="c nd fa n o ne eq nf ng nh ni nj nk nl nm nn no np nq nr mf"><div class="be mk ml mm mn mo ns mq o jo fa n p nt u jg s t ai ay mr bi nu"><svg width="33" height="33" viewBox="0 0 33 33"><path d="M28.86 17.34l-3.64-6.4c-.3-.43-.71-.73-1.16-.8a1.12 1.12 0 0 0-.9.21c-.62.5-.73 1.18-.32 2.06l1.22 2.6 1.4 2.45c2.23 4.09 1.51 8-2.15 11.66a9.6 9.6 0 0 1-.8.71 6.53 6.53 0 0 0 4.3-2.1c3.82-3.82 3.57-7.87 2.05-10.39zm-6.25 11.08c3.35-3.35 4-6.78 1.98-10.47L21.2 12c-.3-.43-.71-.72-1.16-.8a1.12 1.12 0 0 0-.9.22c-.62.49-.74 1.18-.32 2.06l1.72 3.63a.5.5 0 0 1-.81.57l-8.91-8.9a1.33 1.33 0 0 0-1.89 1.88l5.3 5.3a.5.5 0 0 1-.71.7l-5.3-5.3-1.49-1.49c-.5-.5-1.38-.5-1.88 0a1.34 1.34 0 0 0 0 1.89l1.49 1.5 5.3 5.28a.5.5 0 0 1-.36.86.5.5 0 0 1-.36-.15l-5.29-5.29a1.34 1.34 0 0 0-1.88 0 1.34 1.34 0 0 0 0 1.89l2.23 2.23L9.3 21.4a.5.5 0 0 1-.36.85.5.5 0 0 1-.35-.14l-3.32-3.33a1.33 1.33 0 0 0-1.89 0 1.32 1.32 0 0 0-.39.95c0 .35.14.69.4.94l6.39 6.4c3.53 3.53 8.86 5.3 12.82 1.35zM12.73 9.26l5.68 5.68-.49-1.04c-.52-1.1-.43-2.13.22-2.89l-3.3-3.3a1.34 1.34 0 0 0-1.88 0 1.33 1.33 0 0 0-.4.94c0 .22.07.42.17.61zm14.79 19.18a7.46 7.46 0 0 1-6.41 2.31 7.92 7.92 0 0 1-3.67.9c-3.05 0-6.12-1.63-8.36-3.88l-6.4-6.4A2.31 2.31 0 0 1 2 19.72a2.33 2.33 0 0 1 1.92-2.3l-.87-.87a2.34 2.34 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.64l-.14-.14a2.34 2.34 0 0 1 0-3.3 2.39 2.39 0 0 1 3.3 0l.14.14a2.33 2.33 0 0 1 3.95-1.24l.09.09c.09-.42.29-.83.62-1.16a2.34 2.34 0 0 1 3.3 0l3.38 3.39a2.17 2.17 0 0 1 1.27-.17c.54.08 1.03.35 1.45.76.1-.55.41-1.03.9-1.42a2.12 2.12 0 0 1 1.67-.4 2.8 2.8 0 0 1 1.85 1.25l3.65 6.43c1.7 2.83 2.03 7.37-2.2 11.6zM13.22.48l-1.92.89 2.37 2.83-.45-3.72zm8.48.88L19.78.5l-.44 3.7 2.36-2.84zM16.5 3.3L15.48 0h2.04L16.5 3.3z" fill-rule="evenodd"></path></svg></div></div></a></div><div class="ms r"><div class="mt"><h4 class="aq cl fe as dt"><button class="cq cr az ba bb bc bd be bf bg gp gq bj bk fl fm">1.4K claps</button></h4></div></div></div><div class="n o"><div class="go r an"><a href="//medium.com/p/be532be3910e/share/twitter?source=post_actions_footer---------------------------" class="cq cr az ba bb bc bd be bf bg gp gq bj bk fl fm" target="_blank" rel="noopener nofollow"><svg width="29" height="29" class="q"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></a></div><div class="go r an"><button class="cq cr az ba bb bc bd be bf bg gp gq bj bk fl fm"><svg width="29" height="29" viewBox="0 0 29 29" fill="none" class="q"><path d="M5 6.36C5 5.61 5.63 5 6.4 5h16.2c.77 0 1.4.61 1.4 1.36v16.28c0 .75-.63 1.36-1.4 1.36H6.4c-.77 0-1.4-.6-1.4-1.36V6.36z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M10.76 20.9v-8.57H7.89v8.58h2.87zm-1.44-9.75c1 0 1.63-.65 1.63-1.48-.02-.84-.62-1.48-1.6-1.48-.99 0-1.63.64-1.63 1.48 0 .83.62 1.48 1.59 1.48h.01zM12.35 20.9h2.87v-4.79c0-.25.02-.5.1-.7.2-.5.67-1.04 1.46-1.04 1.04 0 1.46.8 1.46 1.95v4.59h2.87v-4.92c0-2.64-1.42-3.87-3.3-3.87-1.55 0-2.23.86-2.61 1.45h.02v-1.24h-2.87c.04.8 0 8.58 0 8.58z" fill="#fff"></path></svg></button></div><div class="go r an"><a href="//medium.com/p/be532be3910e/share/facebook?source=post_actions_footer---------------------------" class="cq cr az ba bb bc bd be bf bg gp gq bj bk fl fm" target="_blank" rel="noopener nofollow"><svg width="29" height="29" class="q"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></a></div><div class="nv r an"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-custom-openai-gym-environment-for-stock-trading-be532be3910e&amp;source=post_actions_footer--------------------------bookmark_sidebar-" class="cq cr az ba bb bc bd be bf bg gp gq bj bk fl fm" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></div></div></div><div class="nw nx ny mw r y"><div class="nz oa r eq"><span class="r ob al oc"><div class="r s od oe"><a href="/@notadamking?source=follow_footer--------------------------follow_footer-" rel="noopener"><div class="eq of ce"><div class="et n eu o p s ev ew ex ey ez dk"><svg width="91" height="91" viewBox="0 0 91 91"><path fill-rule="evenodd" clip-rule="evenodd" d="M45.5 1.4c-17.14 0-32 9.95-39.25 24.5L5 25.28C12.47 10.28 27.8 0 45.5 0S78.53 10.29 86 25.28l-1.25.62C77.5 11.35 62.65 1.4 45.5 1.4zM6.25 65.1c7.25 14.55 22.1 24.5 39.25 24.5 17.14 0 32-9.95 39.25-24.5l1.25.62C78.53 80.72 63.2 91 45.5 91S12.47 80.71 5 65.72l1.25-.62z"></path></svg></div><img alt="Adam King" class="r fa ce of" src="https://miro.medium.com/fit/c/160/160/2*GnXdYdgLDvWhInOVFHxikA.jpeg" width="80" height="80"/></div></a></div><span class="r"><div class="og r oh"><p class="aq cl cm as av co oi">Written by</p></div><div class="og oj n oh"><div class="ai n o em"><h2 class="aq ik kz ok dt"><a href="/@notadamking?source=follow_footer--------------------------follow_footer-" class="cq cr az ba bb bc bd be bf bg gp gq bj bk fl fm" rel="noopener">Adam King</a></h2><div class="r g"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-custom-openai-gym-environment-for-stock-trading-be532be3910e&amp;source=follow_footer-6e3a5234f1cc-------------------------follow_footer-" class="md fp ax ay me bh bi mf bg ga aq b ar as at au gc gd df ge gf bj" rel="noopener">Follow</a></div></div></div></span></span><div class="og ol r oh bp"><div class="om r"><h4 class="aq cl kl on av">Co-Founder, Software Architect, and Deep Learning Enthusiast — Judge me by my age, I dare you https://www.patreon.com/notadamking</h4></div><div class="oo op bp"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-custom-openai-gym-environment-for-stock-trading-be532be3910e&amp;source=follow_footer-6e3a5234f1cc-------------------------follow_footer-" class="md fp ax ay me bh bi mf bg ga aq b ar as at au gc gd df ge gf bj" rel="noopener">Follow</a></div></div></div><div class="nw r"></div><div class="nz oa r eq"><span class="r ob al oc"><div class="r s od oe"><a href="https://towardsdatascience.com/?source=follow_footer--------------------------follow_footer-" rel="noopener"><img alt="Towards Data Science" class="ga of ce" src="https://miro.medium.com/fit/c/160/160/1*hVxgUA6kP-PgL5TJjuyePg.png" width="80" height="80"/></a></div><span class="r"><div class="og oj n oh"><div class="ai n o em"><h2 class="aq ik kz ok dt"><a href="https://towardsdatascience.com/?source=follow_footer--------------------------follow_footer-" class="cq cr az ba bb bc bd be bf bg gp gq bj bk fl fm" rel="noopener">Towards Data Science</a></h2><div class="r g"><div class="ge" aria-hidden="true"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-custom-openai-gym-environment-for-stock-trading-be532be3910e&amp;source=follow_footer--------------------------follow_footer-" class="md fp ax ay me bh bi mf bg ga aq b ar as at au gc gd df ge gf bj" rel="noopener">Follow</a></div></div></div></div></span></span><div class="og oq r oh bp"><div class="om r"><h4 class="aq cl kl on av">A Medium publication sharing concepts, ideas, and codes.</h4></div><div class="oo op bp"><div class="ge" aria-hidden="true"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-custom-openai-gym-environment-for-stock-trading-be532be3910e&amp;source=follow_footer--------------------------follow_footer-" class="md fp ax ay me bh bi mf bg ga aq b ar as at au gc gd df ge gf bj" rel="noopener">Follow</a></div></div></div></div></div><div class="or nx r y"><a href="https://medium.com/p/be532be3910e/responses/show?source=follow_footer--------------------------follow_footer-" class="cq cr az ba bb bc bd be bf bg gp gq bj bk fl fm" rel="noopener"><span class="os ot mn"><div class="hx ou ga r lc bp"><span class="ax">See responses (17)</span></div></span></a></div></div></div><div class="ov r ow y"><div class="n p"><div class="z ab ac ae af ag ah ai"><div class="ox r oy"><div class="oz ly nz r"><h2 class="aq ik pa pb dt">More From Medium</h2></div><div class="cb n eu mv pc pd pe pf pg ph pi pj pk pl pm pn po pp pq"><div class="pr ps pt pu pv pw px py pz qa qb qc qd qe qf qg qh qi qj qk ql"><div class="ai jg"><div class="r qm"><div class="qn qo pc pd pe qp qq pf pg ph qr qs pi pj pk qt qu pl pm pn qv qw po pp pq n mv"><div class="pr ps pt pu pv pw qx qy pz qa qz ra qd qe rb rc qh qi rd re ql"><div class="rf r rg f"><h4 class="aq cl fe as av">More from Towards Data Science</h4></div><div class="rh r ri oy"><a class="cq cr az ba bb bc bd be bf bg gp gq bj bk fl fm r" rel="noopener" href="/top-3-python-functions-you-dont-know-about-probably-978f4be1e6d?source=post_recirc---------0------------------"><div class="rj eq"><div class="jg s ai"><div class="rk r ks kt jg ai kv kw"></div></div></div></a></div></div><div class="pr ps pt pu pv pw qx qy pz qa qz ra qd qe rb rc qh qi rd re ql"><div class="rh r"><div class="rl oo h rm"><h4 class="aq cl fe as av">More from Towards Data Science</h4></div><a rel="noopener" href="/top-3-python-functions-you-dont-know-about-probably-978f4be1e6d?source=post_recirc---------0------------------"><h3 class="dt q du rn ar ro rp rq">Top 3 Python Functions You Don’t Know About (Probably)</h3></a></div><div class="n o em"><div class="rr r bw"><div class="o n"><div><a href="/@radecicdario?source=post_recirc---------0------------------" rel="noopener"><div class="eq rs rt"><div class="et n eu o p s ev ew ex ey ez dk"><svg width="49" height="49" viewBox="0 0 49 49"><path fill-rule="evenodd" clip-rule="evenodd" d="M24.5 1.1c-9.39 0-17.53 5.55-21.51 13.66L2 14.28C6.15 5.82 14.66 0 24.5 0S42.85 5.82 47 14.28l-.99.48C42.03 6.65 33.9 1.1 24.5 1.1zM2.99 34.24C6.97 42.35 15.1 47.9 24.5 47.9c9.39 0 17.53-5.55 21.51-13.66l.99.48C42.85 43.18 34.34 49 24.5 49S6.15 43.18 2 34.72l.99-.48z"></path></svg></div><img alt="Dario Radečić" class="r fa rt rs" src="https://miro.medium.com/fit/c/80/80/2*VmdbajrpX9nwOc9UtkV3Yg.png" width="40" height="40"/></div></a></div><div class="fb ai r"><div class="n"><div style="flex:1"><span class="aq b ar as at au r dt q"><div class="cw n o fd"><span class="aq cl fe as br ff fg fh fi fj dt"><a href="/@radecicdario?source=post_recirc---------0------------------" class="cq cr az ba bb bc bd be bf bg fk bj bk fl fm" rel="noopener">Dario Radečić</a><span> <!-- -->in<!-- --> <a href="https://towardsdatascience.com/?source=post_recirc---------0------------------" class="cq cr az ba bb bc bd be bf bg fk bj bk fl fm" rel="noopener">Towards Data Science</a></span></span></div></span></div></div><span class="aq b ar as at au r av aw"><span class="aq cl fe as br ff fg fh fi fj av"><div><a class="cq cr az ba bb bc bd be bf bg fk bj bk fl fm" rel="noopener" href="/top-3-python-functions-you-dont-know-about-probably-978f4be1e6d?source=post_recirc---------0------------------">Mar 14</a> <!-- -->·<!-- --> <!-- -->4<!-- --> min read<span style="padding-left:4px"><svg class="star-15px_svg__svgIcon-use" width="15" height="15" viewBox="0 0 15 15" style="margin-top:-2px"><path d="M7.44 2.32c.03-.1.09-.1.12 0l1.2 3.53a.29.29 0 0 0 .26.2h3.88c.11 0 .13.04.04.1L9.8 8.33a.27.27 0 0 0-.1.29l1.2 3.53c.03.1-.01.13-.1.07l-3.14-2.18a.3.3 0 0 0-.32 0L4.2 12.22c-.1.06-.14.03-.1-.07l1.2-3.53a.27.27 0 0 0-.1-.3L2.06 6.16c-.1-.06-.07-.12.03-.12h3.89a.29.29 0 0 0 .26-.19l1.2-3.52z"></path></svg></span></div></span></span></div></div></div><div class="n o"><div class="n o"><div class="mj r eq"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-custom-openai-gym-environment-for-stock-trading-be532be3910e&amp;source=post_recirc-----978f4be1e6d----0-----------------clap_preview-" class="cq cr az ba bb bc bd be bf bg gp gq bj bk fl fm" rel="noopener"><div class="be mk ml mm mn mo mp mq ru rv rw"><svg width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></div><div class="ms r"><div class="mt"><h4 class="aq cl fe as av">2.8K </h4></div></div></div><div class="rx fb rr cf ry r"></div><div><div class="ge" role="tooltip" aria-hidden="true"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-custom-openai-gym-environment-for-stock-trading-be532be3910e&amp;source=post_recirc---------0-----------------bookmark_sidebar-" class="cq cr az ba bb bc bd be bf bg gp gq bj bk fl fm" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></div></div></div></div></div></div></div></div></div><div class="pr ps pt pu pv pw px py pz qa qb qc qd qe qf qg qh qi qj qk ql"><div class="ai jg"><div class="r qm"><div class="qn qo pc pd pe qp qq pf pg ph qr qs pi pj pk qt qu pl pm pn qv qw po pp pq n mv"><div class="pr ps pt pu pv pw qx qy pz qa qz ra qd qe rb rc qh qi rd re ql"><div class="rf r rg f"><h4 class="aq cl fe as av">More from Towards Data Science</h4></div><div class="rh r ri oy"><a class="cq cr az ba bb bc bd be bf bg gp gq bj bk fl fm r" rel="noopener" href="/i-thought-i-was-mastering-python-until-i-discovered-these-tricks-e40d9c71f4e2?source=post_recirc---------1------------------"><div class="rj eq"><div class="jg s ai"><div class="rz r ks kt jg ai kv kw"></div></div></div></a></div></div><div class="pr ps pt pu pv pw qx qy pz qa qz ra qd qe rb rc qh qi rd re ql"><div class="rh r"><div class="rl oo h rm"><h4 class="aq cl fe as av">More from Towards Data Science</h4></div><a rel="noopener" href="/i-thought-i-was-mastering-python-until-i-discovered-these-tricks-e40d9c71f4e2?source=post_recirc---------1------------------"><h3 class="dt q du rn ar ro rp rq">I Thought I Was Mastering Python Until I Discovered These Tricks</h3></a></div><div class="n o em"><div class="rr r bw"><div class="o n"><div><a href="/@chouhbik?source=post_recirc---------1------------------" rel="noopener"><img alt="Kamal Chouhbi" class="r fa rt rs" src="https://miro.medium.com/fit/c/80/80/2*dOYKOKixC3TvWiKndwLu4w.jpeg" width="40" height="40"/></a></div><div class="fb ai r"><div class="n"><div style="flex:1"><span class="aq b ar as at au r dt q"><div class="cw n o fd"><span class="aq cl fe as br ff fg fh fi fj dt"><a href="/@chouhbik?source=post_recirc---------1------------------" class="cq cr az ba bb bc bd be bf bg fk bj bk fl fm" rel="noopener">Kamal Chouhbi</a><span> <!-- -->in<!-- --> <a href="https://towardsdatascience.com/?source=post_recirc---------1------------------" class="cq cr az ba bb bc bd be bf bg fk bj bk fl fm" rel="noopener">Towards Data Science</a></span></span></div></span></div></div><span class="aq b ar as at au r av aw"><span class="aq cl fe as br ff fg fh fi fj av"><div><a class="cq cr az ba bb bc bd be bf bg fk bj bk fl fm" rel="noopener" href="/i-thought-i-was-mastering-python-until-i-discovered-these-tricks-e40d9c71f4e2?source=post_recirc---------1------------------">Mar 6</a> <!-- -->·<!-- --> <!-- -->9<!-- --> min read<span style="padding-left:4px"><svg class="star-15px_svg__svgIcon-use" width="15" height="15" viewBox="0 0 15 15" style="margin-top:-2px"><path d="M7.44 2.32c.03-.1.09-.1.12 0l1.2 3.53a.29.29 0 0 0 .26.2h3.88c.11 0 .13.04.04.1L9.8 8.33a.27.27 0 0 0-.1.29l1.2 3.53c.03.1-.01.13-.1.07l-3.14-2.18a.3.3 0 0 0-.32 0L4.2 12.22c-.1.06-.14.03-.1-.07l1.2-3.53a.27.27 0 0 0-.1-.3L2.06 6.16c-.1-.06-.07-.12.03-.12h3.89a.29.29 0 0 0 .26-.19l1.2-3.52z"></path></svg></span></div></span></span></div></div></div><div class="n o"><div class="n o"><div class="mj r eq"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-custom-openai-gym-environment-for-stock-trading-be532be3910e&amp;source=post_recirc-----e40d9c71f4e2----1-----------------clap_preview-" class="cq cr az ba bb bc bd be bf bg gp gq bj bk fl fm" rel="noopener"><div class="be mk ml mm mn mo mp mq ru rv rw"><svg width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></div><div class="ms r"><div class="mt"><h4 class="aq cl fe as av">3.9K </h4></div></div></div><div class="rx fb rr cf ry r"></div><div><div class="ge" role="tooltip" aria-hidden="true"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-custom-openai-gym-environment-for-stock-trading-be532be3910e&amp;source=post_recirc---------1-----------------bookmark_sidebar-" class="cq cr az ba bb bc bd be bf bg gp gq bj bk fl fm" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></div></div></div></div></div></div></div></div></div><div class="pr ps pt pu pv pw px py pz qa qb qc qd qe qf qg qh qi qj qk ql"><div class="ai jg"><div class="r qm"><div class="qn qo pc pd pe qp qq pf pg ph qr qs pi pj pk qt qu pl pm pn qv qw po pp pq n mv"><div class="pr ps pt pu pv pw qx qy pz qa qz ra qd qe rb rc qh qi rd re ql"><div class="rf r rg f"><h4 class="aq cl fe as av">More from Towards Data Science</h4></div><div class="rh r ri oy"><a class="cq cr az ba bb bc bd be bf bg gp gq bj bk fl fm r" rel="noopener" href="/9-reasons-why-youll-never-become-a-data-scientist-c8c5b75503cf?source=post_recirc---------2------------------"><div class="rj eq"><div class="jg s ai"><div class="sa r ks kt jg ai kv kw"></div></div></div></a></div></div><div class="pr ps pt pu pv pw qx qy pz qa qz ra qd qe rb rc qh qi rd re ql"><div class="rh r"><div class="rl oo h rm"><h4 class="aq cl fe as av">More from Towards Data Science</h4></div><a rel="noopener" href="/9-reasons-why-youll-never-become-a-data-scientist-c8c5b75503cf?source=post_recirc---------2------------------"><h3 class="dt q du rn ar ro rp rq">9 Reasons why you’ll never become a Data Scientist</h3></a></div><div class="n o em"><div class="rr r bw"><div class="o n"><div><a href="/@rheamoutafis?source=post_recirc---------2------------------" rel="noopener"><div class="eq rs rt"><div class="et n eu o p s ev ew ex ey ez dk"><svg width="49" height="49" viewBox="0 0 49 49"><path fill-rule="evenodd" clip-rule="evenodd" d="M24.5 1.1c-9.39 0-17.53 5.55-21.51 13.66L2 14.28C6.15 5.82 14.66 0 24.5 0S42.85 5.82 47 14.28l-.99.48C42.03 6.65 33.9 1.1 24.5 1.1zM2.99 34.24C6.97 42.35 15.1 47.9 24.5 47.9c9.39 0 17.53-5.55 21.51-13.66l.99.48C42.85 43.18 34.34 49 24.5 49S6.15 43.18 2 34.72l.99-.48z"></path></svg></div><img alt="Rhea Moutafis" class="r fa rt rs" src="https://miro.medium.com/fit/c/80/80/2*8TyJoz2oyfux06hOJujerQ.jpeg" width="40" height="40"/></div></a></div><div class="fb ai r"><div class="n"><div style="flex:1"><span class="aq b ar as at au r dt q"><div class="cw n o fd"><span class="aq cl fe as br ff fg fh fi fj dt"><a href="/@rheamoutafis?source=post_recirc---------2------------------" class="cq cr az ba bb bc bd be bf bg fk bj bk fl fm" rel="noopener">Rhea Moutafis</a><span> <!-- -->in<!-- --> <a href="https://towardsdatascience.com/?source=post_recirc---------2------------------" class="cq cr az ba bb bc bd be bf bg fk bj bk fl fm" rel="noopener">Towards Data Science</a></span></span></div></span></div></div><span class="aq b ar as at au r av aw"><span class="aq cl fe as br ff fg fh fi fj av"><div><a class="cq cr az ba bb bc bd be bf bg fk bj bk fl fm" rel="noopener" href="/9-reasons-why-youll-never-become-a-data-scientist-c8c5b75503cf?source=post_recirc---------2------------------">Mar 8</a> <!-- -->·<!-- --> <!-- -->7<!-- --> min read<span style="padding-left:4px"><svg class="star-15px_svg__svgIcon-use" width="15" height="15" viewBox="0 0 15 15" style="margin-top:-2px"><path d="M7.44 2.32c.03-.1.09-.1.12 0l1.2 3.53a.29.29 0 0 0 .26.2h3.88c.11 0 .13.04.04.1L9.8 8.33a.27.27 0 0 0-.1.29l1.2 3.53c.03.1-.01.13-.1.07l-3.14-2.18a.3.3 0 0 0-.32 0L4.2 12.22c-.1.06-.14.03-.1-.07l1.2-3.53a.27.27 0 0 0-.1-.3L2.06 6.16c-.1-.06-.07-.12.03-.12h3.89a.29.29 0 0 0 .26-.19l1.2-3.52z"></path></svg></span></div></span></span></div></div></div><div class="n o"><div class="n o"><div class="mj r eq"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-custom-openai-gym-environment-for-stock-trading-be532be3910e&amp;source=post_recirc-----c8c5b75503cf----2-----------------clap_preview-" class="cq cr az ba bb bc bd be bf bg gp gq bj bk fl fm" rel="noopener"><div class="be mk ml mm mn mo mp mq ru rv rw"><svg width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></div><div class="ms r"><div class="mt"><h4 class="aq cl fe as av">3K </h4></div></div></div><div class="rx fb rr cf ry r"></div><div><div class="ge" role="tooltip" aria-hidden="true"><a href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fcreating-a-custom-openai-gym-environment-for-stock-trading-be532be3910e&amp;source=post_recirc---------2-----------------bookmark_sidebar-" class="cq cr az ba bb bc bd be bf bg gp gq bj bk fl fm" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="sb r sc sd"><section class="dc dd ai df r se sf sg sh si sj sk sl sm sn so sp sq sr ss"><div class="st su nz n em g"><div class="sv n em"><div class="sw r sx"><div class="sy r"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----be532be3910e----------------------" class="cq cr az ba bb bc bd be bf bg sz ta bj bk tb tc" rel="noopener"><h4 class="td te tf aq ik ar on tg th r">Discover <!-- -->Medium</h4></a></div><span class="aq b ar as at au r ti tj">Welcome to a place where words matter. On <!-- -->Medium<!-- -->, smart voices and original ideas take center stage - with no ads in sight.<!-- --> <a href="https://medium.com/about?autoplay=1&amp;source=post_page-----be532be3910e----------------------" class="cq cr az ba bb bc bd be bf bg bj bk tb tc tk" rel="noopener">Watch</a></span></div><div class="sw r sx"><div class="oz r"><a href="https://medium.com/topics?source=post_page-----be532be3910e----------------------" class="cq cr az ba bb bc bd be bf bg sz ta bj bk tb tc" rel="noopener"><h4 class="td te tf aq ik ar on tg th r">Make <!-- -->Medium<!-- --> yours</h4></a></div><span class="aq b ar as at au r ti tj">Follow all the topics you care about, and we’ll deliver the best stories for you to your homepage and inbox.<!-- --> <a href="https://medium.com/topics?source=post_page-----be532be3910e----------------------" class="cq cr az ba bb bc bd be bf bg bj bk tb tc tk" rel="noopener">Explore</a></span></div><div class="sw r sx"><div class="sy r"><a href="https://medium.com/membership?source=post_page-----be532be3910e----------------------" class="cq cr az ba bb bc bd be bf bg sz ta bj bk tb tc" rel="noopener"><h4 class="td te tf aq ik ar on tg th r">Become a member</h4></a></div><span class="aq b ar as at au r ti tj">Get unlimited access to the best stories on <!-- -->Medium<!-- --> — and support writers while you’re at it. Just $5/month.<!-- --> <a href="https://medium.com/membership?source=post_page-----be532be3910e----------------------" class="cq cr az ba bb bc bd be bf bg bj bk tb tc tk" rel="noopener">Upgrade</a></span></div></div></div><div class="n o em"><a href="https://medium.com/?source=post_page-----be532be3910e----------------------" class="cq cr az ba bb bc bd be bf bg sz ta bj bk tb tc" rel="noopener"><svg height="22" width="112" viewBox="0 0 111.5 22" class="te"><path d="M56.3 19.5c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5V19c-.7 1.8-2.4 3-4.3 3-3.3 0-5.8-2.6-5.8-7.5 0-4.5 2.6-7.6 6.3-7.6 1.6-.1 3.1.8 3.8 2.4V3.2c0-.3-.1-.6-.3-.7l-1.4-1.4V1l6.5-.8v19.3zm-4.8-.8V9.5c-.5-.6-1.2-.9-1.9-.9-1.6 0-3.1 1.4-3.1 5.7 0 4 1.3 5.4 3 5.4.8.1 1.6-.3 2-1zm9.1 3.1V9.4c0-.3-.1-.6-.3-.7l-1.4-1.5v-.1h6.5v12.5c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5zm-.2-19.2C60.4 1.2 61.5 0 63 0c1.4 0 2.6 1.2 2.6 2.6S64.4 5.3 63 5.3a2.6 2.6 0 0 1-2.6-2.7zm22.5 16.9c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5v-3.2c-.6 2-2.4 3.4-4.5 3.4-2.9 0-4.4-2.1-4.4-6.2 0-1.9 0-4.1.1-6.5 0-.3-.1-.5-.3-.7L67.7 7v.1H74v8c0 2.6.4 4.4 2 4.4.9-.1 1.7-.6 2.1-1.3V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v12.4zm22 2.3c0-.5.1-6.5.1-7.9 0-2.6-.4-4.5-2.2-4.5-.9 0-1.8.5-2.3 1.3.2.8.3 1.7.3 2.5 0 1.8-.1 4.2-.1 6.5 0 .3.1.5.3.7l1.5 1.4v.1H96c0-.4.1-6.5.1-7.9 0-2.7-.4-4.5-2.2-4.5-.9 0-1.7.5-2.2 1.3v9c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v3.1a4.6 4.6 0 0 1 4.6-3.4c2.2 0 3.6 1.2 4.2 3.5.7-2.1 2.7-3.6 4.9-3.5 2.9 0 4.5 2.2 4.5 6.2 0 1.9-.1 4.2-.1 6.5-.1.3.1.6.3.7l1.4 1.4v.1h-6.6zm-81.4-2l1.9 1.9v.1h-9.8v-.1l2-1.9c.2-.2.3-.4.3-.7V7.3c0-.5 0-1.2.1-1.8L11.4 22h-.1L4.5 6.8c-.1-.4-.2-.4-.3-.6v10c-.1.7 0 1.3.3 1.9l2.7 3.6v.1H0v-.1L2.7 18c.3-.6.4-1.3.3-1.9v-11c0-.5-.1-1.1-.5-1.5L.7 1.1V1h7l5.8 12.9L18.6 1h6.8v.1l-1.9 2.2c-.2.2-.3.5-.3.7v15.2c0 .2.1.5.3.6zm7.6-5.9c0 3.8 1.9 5.3 4.2 5.3 1.9.1 3.6-1 4.4-2.7h.1c-.8 3.7-3.1 5.5-6.5 5.5-3.7 0-7.2-2.2-7.2-7.4 0-5.5 3.5-7.6 7.3-7.6 3.1 0 6.4 1.5 6.4 6.2v.8h-8.7zm0-.8h4.3v-.8c0-3.9-.8-4.9-2-4.9-1.4.1-2.3 1.6-2.3 5.7z"></path></svg></a><span class="aq b ar as at au r ti tj"><div class="tl tm n em tn al"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----be532be3910e----------------------" class="cq cr az ba bb bc bd be bf bg fk bj bk tb tc" rel="noopener">About</a><a href="https://help.medium.com/?source=post_page-----be532be3910e----------------------" class="cq cr az ba bb bc bd be bf bg fk bj bk tb tc" rel="noopener">Help</a><a href="https://medium.com/policy/9db0094a1e0f?source=post_page-----be532be3910e----------------------" class="cq cr az ba bb bc bd be bf bg fk bj bk tb tc" rel="noopener">Legal</a></div></span></div></section></div></div></div><script src="https://cdn.optimizely.com/js/16180790160.js"></script><script>window.__BUILD_ID__ = "master-20200319-011735-b147f3f569"</script><script>window.__GRAPHQL_URI__ = "https://towardsdatascience.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"config":{"nodeEnv":"production","version":"master-20200319-011735-b147f3f569","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","lightStep":{"name":"lite-web","host":"collector-medium.lightstep.com","token":"ce5be895bef60919541332990ac9fef2","appVersion":"master-20200319-011735-b147f3f569"},"algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","datadog":{"context":{"deployment":{"target":"production","tag":"master-20200319-011735-b147f3f569","commit":"b147f3f5695e47afc2f90f518446837a21a1bb0d"}}},"sentry":{"dsn":"https:\u002F\u002F589e367c28ca47b195ce200d1507d18b@sentry.io\u002F1423575","environment":"production"},"isAmp":false,"googleAnalyticsCode":"UA-24232453-2","signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumOwnedAndOperatedCollectionIds":["544c7006046e","bcc38c8f6edf","444d13b52878","8d6b8a439e32","92d2092dc598","1285ba81cada","cb8577c9149e","8ccfed20cbb2","ae2a65f35510","3f6ecf56618","7b6769f2748b","fc8964313712","ef8e90590e66","191186aaafa0","d944778ce714","bdc4052bbdba","88d9857e584e"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"internalLinksPostIds":["0000","0001","0002","0003"],"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*3sela1OADrJr7dJk_CXaEQ.png","height":810,"width":1440}},"performanceTags":[],"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"d295e12ad17d"}},"debug":{"requestId":"8f022640-4375-49f2-a513-4d8b2af1ad98","originalSpanCarrier":{"ot-tracer-spanid":"668ba4347d947d01","ot-tracer-traceid":"2b415d1264441a2e","ot-tracer-sampled":"true"}},"session":{"user":{"id":"lo_F1wWvpDwEL3Y"},"xsrf":""},"stats":{"itemCount":0,"sending":false,"timeout":null,"backup":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":true},"hideGoogleOneTap":false,"hasRenderedGoogleOneTap":null,"currentLocation":"https:\u002F\u002Ftowardsdatascience.com\u002Fcreating-a-custom-openai-gym-environment-for-stock-trading-be532be3910e","host":"towardsdatascience.com","hostname":"towardsdatascience.com","susiModal":{"step":null,"operation":"register","reportEventInfo":{"eventName":"","data":{}}},"postRead":false},"client":{"isBot":false,"isEu":false,"isLinkedin":false,"isNativeMedium":false,"isCustomDomain":true},"multiVote":{"clapsPerPost":{}},"metadata":{"faviconImageId":null}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY.variantFlags.0":{"name":"add_friction_to_signup","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.0.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.0.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.1":{"name":"allow_access","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.1.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.1.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.2":{"name":"allow_signup","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.2.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.2.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.3":{"name":"allow_test_auth","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.3.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.3.valueType":{"__typename":"VariantFlagString","value":"disallow"},"ROOT_QUERY.variantFlags.4":{"name":"assign_default_topic_to_posts","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.4.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.4.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.5":{"name":"available_annual_plan","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.5.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.5.valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"},"ROOT_QUERY.variantFlags.6":{"name":"available_monthly_plan","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.6.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.6.valueType":{"__typename":"VariantFlagString","value":"60e220181034"},"ROOT_QUERY.variantFlags.7":{"name":"branch_seo_metadata","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.7.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.7.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.8":{"name":"browsable_stream_config_bucket","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.8.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.8.valueType":{"__typename":"VariantFlagString","value":"curated-topics"},"ROOT_QUERY.variantFlags.9":{"name":"disable_android_subscription_activity_carousel","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.9.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.9.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.10":{"name":"disable_gosocial_followers_that_you_follow","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.10.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.10.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.11":{"name":"disable_ios_resume_reading_toast","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.11.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.11.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.12":{"name":"disable_ios_subscription_activity_carousel","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.12.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.12.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.13":{"name":"disable_mobile_featured_chunk","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.13.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.13.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.14":{"name":"disable_post_recommended_from_friends_provider","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.14.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.14.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.15":{"name":"enable_android_local_currency","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.15.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.15.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.16":{"name":"enable_annual_renewal_reminder_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.16.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.16.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.17":{"name":"enable_app_flirty_thirty","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.17.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.17.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.18":{"name":"enable_apple_grace_period","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.18.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.18.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.19":{"name":"enable_auto_tier","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.19.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.19.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.20":{"name":"enable_automated_mission_control_triggers","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.20.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.20.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.21":{"name":"enable_branch_io","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.21.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.21.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.22":{"name":"enable_branding","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.22.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.22.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.23":{"name":"enable_branding_fonts","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.23.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.23.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.24":{"name":"enable_curation_priority_queue_experiment","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.24.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.24.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.25":{"name":"enable_dedicated_series_tab_api_ios","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.25.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.25.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.26":{"name":"enable_different_grid","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.26.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.26.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.27":{"name":"enable_digest_feature_logging","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.27.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.27.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.28":{"name":"enable_disregard_trunc_state_for_footer","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.28.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.28.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.29":{"name":"enable_edit_alt_text","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.29.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.29.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.30":{"name":"enable_email_sign_in_captcha","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.30.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.30.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.31":{"name":"enable_embedding_based_diversification","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.31.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.31.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.32":{"name":"enable_ev_mission_email_v3","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.32.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.32.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.33":{"name":"enable_expanded_feature_chunk_pool","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.33.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.33.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.34":{"name":"enable_filter_by_resend_rules","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.34.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.34.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.35":{"name":"enable_filter_expire_processor","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.35.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.35.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.36":{"name":"enable_first_name_on_paywall","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.36.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.36.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.37":{"name":"enable_free_corona_topic","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.37.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.37.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.38":{"name":"enable_google_one_tap","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.38.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.38.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.39":{"name":"enable_grace_period_google_play","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.39.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.39.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.40":{"name":"enable_ios_post_stats","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.40.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.40.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.41":{"name":"enable_janky_spam_rules","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.41.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.41.valueType":{"__typename":"VariantFlagString","value":"users,posts"},"ROOT_QUERY.variantFlags.42":{"name":"enable_json_logs_trained_ranker","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.42.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.42.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.43":{"name":"enable_kafka_events","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.43.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.43.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.44":{"name":"enable_kbfd_rex","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.44.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.44.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.45":{"name":"enable_kbfd_rex_app_highlights","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.45.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.45.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.46":{"name":"enable_kbfd_rex_daily_digest","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.46.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.46.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.47":{"name":"enable_lite_notifications","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.47.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.47.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.48":{"name":"enable_lite_post","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.48.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.48.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.49":{"name":"enable_lite_post_cd","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.49.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.49.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.50":{"name":"enable_lite_post_highlights","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.50.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.50.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.51":{"name":"enable_lite_post_highlights_view_only","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.51.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.51.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.52":{"name":"enable_lite_profile","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.52.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.52.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.53":{"name":"enable_lite_pub_header_menu","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.53.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.53.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.54":{"name":"enable_lite_server_upstream_deadlines","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.54.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.54.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.55":{"name":"enable_lite_stories","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.55.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.55.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.56":{"name":"enable_lite_topics","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.56.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.56.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.57":{"name":"enable_lite_unread_notification_count_mutation","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.57.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.57.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.58":{"name":"enable_lo_homepage","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.58.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.58.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.59":{"name":"enable_lo_meter_swap","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.59.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.59.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.60":{"name":"enable_logged_out_homepage_signup","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.60.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.60.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.61":{"name":"enable_login_code_flow","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.61.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.61.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.62":{"name":"enable_marketing_emails","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.62.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.62.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.63":{"name":"enable_media_resource_try_catch","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.63.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.63.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.64":{"name":"enable_membership_remove_section_a","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.64.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.64.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.65":{"name":"enable_minimal_meter_v2","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.65.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.65.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.66":{"name":"enable_miro_on_kubernetes","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.66.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.66.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.67":{"name":"enable_ml_rank_modules","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.67.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.67.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.68":{"name":"enable_monthly_membership_default","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.68.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.68.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.69":{"name":"enable_mute","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.69.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.69.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.70":{"name":"enable_new_collaborative_filtering_data","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.70.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.70.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.71":{"name":"enable_new_suspended_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.71.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.71.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.72":{"name":"enable_new_three_dot_menu","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.72.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.72.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.73":{"name":"enable_optimizely","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.73.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.73.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.74":{"name":"enable_pardon_the_interruption_removal","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.74.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.74.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.75":{"name":"enable_parsely","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.75.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.75.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.76":{"name":"enable_patronus_on_kubernetes","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.76.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.76.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.77":{"name":"enable_popularity_feature","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.77.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.77.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.78":{"name":"enable_post_import","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.78.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.78.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.79":{"name":"enable_post_page_nav_stickiness_removal","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.79.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.79.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.80":{"name":"enable_post_seo_settings_screen","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.80.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.80.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.81":{"name":"enable_post_settings_screen","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.81.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.81.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.82":{"name":"enable_primary_topic_for_mobile","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.82.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.82.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.83":{"name":"enable_recaptcha_v3","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.83.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.83.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.84":{"name":"enable_rito_upstream_deadlines","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.84.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.84.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.85":{"name":"enable_rtr_channel","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.85.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.85.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.86":{"name":"enable_save_to_medium","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.86.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.86.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.87":{"name":"enable_sign_up_with_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.87.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.87.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.88":{"name":"enable_suggest_account","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.88.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.88.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.89":{"name":"enable_suggest_account_li","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.89.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.89.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.90":{"name":"enable_tick_landing_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.90.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.90.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.91":{"name":"enable_tipalti_onboarding","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.91.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.91.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.92":{"name":"enable_tribute_landing_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.92.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.92.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.93":{"name":"enable_trumpland_landing_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.93.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.93.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.94":{"name":"filter_low_scoring_users","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.94.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.94.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.95":{"name":"glyph_font_set","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.95.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.95.valueType":{"__typename":"VariantFlagString","value":"m2"},"ROOT_QUERY.variantFlags.96":{"name":"google_sign_in_android","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.96.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.96.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.97":{"name":"iceland_home_page_loadtest","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.97.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.97.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.98":{"name":"is_not_medium_subscriber","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.98.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.98.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.99":{"name":"new_transition_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.99.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.99.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.100":{"name":"pardon_the_interruption_4","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.100.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.100.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.101":{"name":"pub_sidebar","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.101.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.101.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.102":{"name":"rank_model","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.102.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.102.valueType":{"__typename":"VariantFlagString","value":"default"},"ROOT_QUERY.variantFlags.103":{"name":"redis_read_write_splitting","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.103.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.103.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.104":{"name":"share_post_linkedin","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.104.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.104.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.105":{"name":"signin_services","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.105.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.105.valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"},"ROOT_QUERY.variantFlags.106":{"name":"signup_services","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.106.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.106.valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"},"ROOT_QUERY.variantFlags.107":{"name":"use_new_admin_topic_backend","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.107.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.107.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY":{"variantFlags":[{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.0","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.1","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.2","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.3","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.4","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.5","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.6","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.7","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.8","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.9","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.10","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.11","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.12","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.13","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.14","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.15","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.16","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.17","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.18","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.19","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.20","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.21","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.22","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.23","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.24","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.25","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.26","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.27","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.28","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.29","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.30","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.31","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.32","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.33","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.34","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.35","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.36","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.37","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.38","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.39","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.40","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.41","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.42","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.43","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.44","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.45","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.46","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.47","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.48","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.49","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.50","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.51","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.52","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.53","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.54","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.55","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.56","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.57","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.58","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.59","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.60","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.61","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.62","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.63","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.64","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.65","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.66","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.67","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.68","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.69","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.70","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.71","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.72","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.73","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.74","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.75","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.76","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.77","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.78","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.79","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.80","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.81","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.82","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.83","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.84","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.85","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.86","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.87","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.88","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.89","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.90","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.91","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.92","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.93","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.94","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.95","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.96","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.97","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.98","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.99","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.100","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.101","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.102","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.103","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.104","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.105","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.106","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.107","typename":"VariantFlag"}],"viewer":null,"meterPost({\"postId\":\"be532be3910e\",\"postMeteringOptions\":{}})":{"type":"id","generated":false,"id":"MeteringInfo:singleton","typename":"MeteringInfo"},"postResult({\"id\":\"be532be3910e\"})":{"type":"id","generated":false,"id":"Post:be532be3910e","typename":"Post"}},"MeteringInfo:singleton":{"__typename":"MeteringInfo","postIds":{"type":"json","json":["338969e24d30","be532be3910e","53ce18025f97"]},"maxUnlockCount":3,"unlocksRemaining":0},"Post:be532be3910e":{"__typename":"Post","id":"be532be3910e","visibility":"LOCKED","latestPublishedVersion":"fe0bdba4209c","collection":{"type":"id","generated":false,"id":"Collection:7f60cf5620c9","typename":"Collection"},"creator":{"type":"id","generated":false,"id":"User:6e3a5234f1cc","typename":"User"},"isLocked":true,"lockedSource":"LOCKED_POST_SOURCE_UGC","sequence":null,"mediumUrl":"https:\u002F\u002Ftowardsdatascience.com\u002Fcreating-a-custom-openai-gym-environment-for-stock-trading-be532be3910e","canonicalUrl":"","content({\"postMeteringOptions\":{}})":{"type":"id","generated":true,"id":"$Post:be532be3910e.content({\"postMeteringOptions\":{}})","typename":"PostContent"},"firstPublishedAt":1554880551225,"isPublished":true,"layerCake":4,"primaryTopic":null,"title":"Creating a Custom OpenAI Gym Environment for Stock Trading","isLimitedState":false,"pendingCollection":null,"shareKey":null,"statusForCollection":"APPROVED","readingTime":7.060377358490566,"readingList":"READING_LIST_NONE","allowResponses":true,"clapCount":1449,"viewerClapCount":0,"license":"ALL_RIGHTS_RESERVED","tags":[{"type":"id","generated":false,"id":"Tag:machine-learning","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:stock-trading","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:deep-learning","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:openai-gym","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:stock-market","typename":"Tag"}],"topics":[],"recirc({\"paging\":{\"limit\":3}})":{"type":"id","generated":true,"id":"$Post:be532be3910e.recirc({\"paging\":{\"limit\":3}})","typename":"RecircItemConnection"},"voterCount":190,"recommenders":[],"postResponses":{"type":"id","generated":true,"id":"$Post:be532be3910e.postResponses","typename":"PostResponses"},"responsesCount":17,"collaborators":[],"translationSourcePost":null,"newsletterId":"","inResponseToPostResult":null,"inResponseToMediaResource":null,"curationEligibleAt":1557963051117,"isDistributionAlertDismissed":false,"audioVersionUrl":"","seoTitle":"","socialTitle":"","socialDek":"","metaDescription":"","latestPublishedAt":1571287254380,"previewContent":{"type":"id","generated":true,"id":"$Post:be532be3910e.previewContent","typename":"PreviewContent"},"previewImage":{"type":"id","generated":false,"id":"ImageMetadata:1*3UNtfZrmEiv3XFKs_xaRcA.jpeg","typename":"ImageMetadata"},"updatedAt":1571287254615,"seoDescription":"","isSuspended":false},"Collection:7f60cf5620c9":{"id":"7f60cf5620c9","domain":"towardsdatascience.com","slug":"towards-data-science","__typename":"Collection","isAuroraVisible":false,"googleAnalyticsId":null,"customStyleSheet":null,"colorBehavior":"ACCENT_COLOR_AND_FILL_BACKGROUND","favicon":{"type":"id","generated":false,"id":"ImageMetadata:1*ChFMdf--f5jbm-AYv6VdYA@2x.png","typename":"ImageMetadata"},"name":"Towards Data Science","logo":{"type":"id","generated":false,"id":"ImageMetadata:1*mG6i4Bh_LgixUYXJgQpYsg@2x.png","typename":"ImageMetadata"},"avatar":{"type":"id","generated":false,"id":"ImageMetadata:1*hVxgUA6kP-PgL5TJjuyePg.png","typename":"ImageMetadata"},"isEnrolledInHightower":false,"creator":{"type":"id","generated":false,"id":"User:895063a310f4","typename":"User"},"viewerIsEditor":false,"navItems":[{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.0","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.1","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.2","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.3","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.4","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.5","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.6","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.7","typename":"NavItem"}],"colorPalette":{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette","typename":"ColorPalette"},"viewerCanEditOwnPosts":false,"viewerCanEditPosts":false,"viewerIsMuting":false,"description":"A Medium publication sharing concepts, ideas, and codes.","viewerIsFollowing":false,"viewerIsSubscribedToLetters":false,"isUserSubscribedToCollectionEmails":false,"ampEnabled":false,"twitterUsername":"TDataScience","facebookPageId":null,"tagline":"A Medium publication sharing concepts, ideas, and codes."},"User:6e3a5234f1cc":{"id":"6e3a5234f1cc","__typename":"User","isSuspended":false,"allowNotes":true,"name":"Adam King","isFollowing":false,"username":"notadamking","bio":"Co-Founder, Software Architect, and Deep Learning Enthusiast — Judge me by my age, I dare you https:\u002F\u002Fwww.patreon.com\u002Fnotadamking","imageId":"2*GnXdYdgLDvWhInOVFHxikA.jpeg","mediumMemberAt":1555437413000,"isBlocking":false,"isMuting":false,"isPartnerProgramEnrolled":false,"twitterScreenName":"notadamking"},"ImageMetadata:1*ChFMdf--f5jbm-AYv6VdYA@2x.png":{"id":"1*ChFMdf--f5jbm-AYv6VdYA@2x.png","__typename":"ImageMetadata"},"ImageMetadata:1*mG6i4Bh_LgixUYXJgQpYsg@2x.png":{"id":"1*mG6i4Bh_LgixUYXJgQpYsg@2x.png","originalWidth":337,"originalHeight":122,"__typename":"ImageMetadata"},"ImageMetadata:1*hVxgUA6kP-PgL5TJjuyePg.png":{"id":"1*hVxgUA6kP-PgL5TJjuyePg.png","__typename":"ImageMetadata"},"User:895063a310f4":{"id":"895063a310f4","__typename":"User"},"Collection:7f60cf5620c9.navItems.0":{"title":"Data Science","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fdata-science\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.1":{"title":"Machine Learning","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fmachine-learning\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.2":{"title":"Programming","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fprogramming\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.3":{"title":"Visualization","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fdata-visualization\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.4":{"title":"AI","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fartificial-intelligence\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.5":{"title":"Picks","url":"https:\u002F\u002Ftowardsdatascience.com\u002Four-picks\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.6":{"title":"More","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fmore\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.7":{"title":"Contribute","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fcontribute\u002Fhome","type":"EXTERNAL_LINK_NAV_ITEM","__typename":"NavItem"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum":{"backgroundColor":"#FF355876","colorPoints":[{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.0","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.1","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.2","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.3","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.4","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.5","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.6","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.7","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.8","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.9","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.10","typename":"ColorPoint"}],"__typename":"ColorSpectrum"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.0":{"color":"#FF355876","point":0,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.1":{"color":"#FF4D6C88","point":0.1,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.2":{"color":"#FF637F99","point":0.2,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.3":{"color":"#FF7791A8","point":0.3,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.4":{"color":"#FF8CA2B7","point":0.4,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.5":{"color":"#FF9FB3C6","point":0.5,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.6":{"color":"#FFB2C3D4","point":0.6,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.7":{"color":"#FFC5D2E1","point":0.7,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.8":{"color":"#FFD7E2EE","point":0.8,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.9":{"color":"#FFE9F1FA","point":0.9,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.10":{"color":"#FFFBFFFF","point":1,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette":{"tintBackgroundSpectrum":{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum","typename":"ColorSpectrum"},"__typename":"ColorPalette","defaultBackgroundSpectrum":{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum","typename":"ColorSpectrum"},"highlightSpectrum":{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum","typename":"ColorSpectrum"}},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum":{"backgroundColor":"#FFFFFFFF","colorPoints":[{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.0","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.1","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.2","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.3","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.4","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.5","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.6","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.7","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.8","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.9","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.10","typename":"ColorPoint"}],"__typename":"ColorSpectrum"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.0":{"color":"#FF668AAA","point":0,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.1":{"color":"#FF61809D","point":0.1,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.2":{"color":"#FF5A7690","point":0.2,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.3":{"color":"#FF546C83","point":0.3,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.4":{"color":"#FF4D6275","point":0.4,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.5":{"color":"#FF455768","point":0.5,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.6":{"color":"#FF3D4C5A","point":0.6,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.7":{"color":"#FF34414C","point":0.7,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.8":{"color":"#FF2B353E","point":0.8,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.9":{"color":"#FF21282F","point":0.9,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.10":{"color":"#FF161B1F","point":1,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum":{"backgroundColor":"#FFFFFFFF","colorPoints":[{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.0","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.1","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.2","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.3","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.4","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.5","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.6","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.7","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.8","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.9","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.10","typename":"ColorPoint"}],"__typename":"ColorSpectrum"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.0":{"color":"#FFEDF4FC","point":0,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.1":{"color":"#FFE9F2FD","point":0.1,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.2":{"color":"#FFE6F1FD","point":0.2,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.3":{"color":"#FFE2EFFD","point":0.3,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.4":{"color":"#FFDFEEFD","point":0.4,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.5":{"color":"#FFDBECFE","point":0.5,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.6":{"color":"#FFD7EBFE","point":0.6,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.7":{"color":"#FFD4E9FE","point":0.7,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.8":{"color":"#FFD0E7FF","point":0.8,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.9":{"color":"#FFCCE6FF","point":0.9,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.10":{"color":"#FFC8E4FF","point":1,"__typename":"ColorPoint"},"$Post:be532be3910e.content({\"postMeteringOptions\":{}})":{"isLockedPreviewOnly":false,"validatedShareKey":"","__typename":"PostContent","bodyModel":{"type":"id","generated":true,"id":"$Post:be532be3910e.content({\"postMeteringOptions\":{}}).bodyModel","typename":"RichText"}},"$Post:be532be3910e.content({\"postMeteringOptions\":{}}).bodyModel.sections.0":{"name":"0045","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:be532be3910e.content({\"postMeteringOptions\":{}}).bodyModel.sections.1":{"name":"5b63","startIndex":71,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:be532be3910e.content({\"postMeteringOptions\":{}}).bodyModel":{"sections":[{"type":"id","generated":true,"id":"$Post:be532be3910e.content({\"postMeteringOptions\":{}}).bodyModel.sections.0","typename":"Section"},{"type":"id","generated":true,"id":"$Post:be532be3910e.content({\"postMeteringOptions\":{}}).bodyModel.sections.1","typename":"Section"}],"paragraphs":[{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_0","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_1","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_2","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_3","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_4","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_5","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_6","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_7","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_8","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_9","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_10","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_11","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_12","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_13","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_14","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_15","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_16","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_17","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_18","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_19","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_20","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_21","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_22","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_23","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_24","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_25","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_26","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_27","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_28","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_29","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_30","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_31","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_32","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_33","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_34","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_35","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_36","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_37","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_38","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_39","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_40","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_41","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_42","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_43","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_44","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_45","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_46","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_47","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_48","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_49","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_50","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_51","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_52","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_53","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_54","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_55","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_56","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_57","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_58","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_59","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_60","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_61","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_62","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_63","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_64","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_65","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_66","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_67","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_68","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_69","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_70","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_71","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_72","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_73","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_74","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:fe0bdba4209c_75","typename":"Paragraph"}],"__typename":"RichText"},"Paragraph:fe0bdba4209c_0":{"id":"fe0bdba4209c_0","name":"501f","type":"H3","href":null,"layout":null,"metadata":null,"text":"Create custom gym environments from scratch — A stock market example","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_1":{"id":"fe0bdba4209c_1","name":"2d07","type":"P","href":null,"layout":null,"metadata":null,"text":"OpenAI’s gym is an awesome package that allows you to create custom reinforcement learning agents. It comes with quite a few pre-built environments like CartPole, MountainCar, and a ton of free Atari games to experiment with.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_1.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_1.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_1.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_1.markups.3","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_1.markups.0":{"type":"CODE","start":9,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_1.markups.1":{"type":"A","start":153,"end":161,"href":"https:\u002F\u002Fgym.openai.com\u002Fenvs\u002F#classic_control","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_1.markups.2":{"type":"A","start":163,"end":174,"href":"https:\u002F\u002Fgym.openai.com\u002Fenvs\u002F#classic_control","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_1.markups.3":{"type":"A","start":180,"end":205,"href":"https:\u002F\u002Fgym.openai.com\u002Fenvs\u002F#atari","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_2":{"id":"fe0bdba4209c_2","name":"2c85","type":"P","href":null,"layout":null,"metadata":null,"text":"These environments are great for learning, but eventually you’ll want to setup an agent to solve a custom problem. To do this, you’ll need to create a custom environment, specific to your problem domain. Later, we will create a custom stock market environment for simulating stock trades. All of the code for this article will be available on my GitHub.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_2.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_2.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_2.markups.0":{"type":"A","start":346,"end":352,"href":"https:\u002F\u002Fgithub.com\u002Fnotadamking\u002FStock-Trading-Environment","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_2.markups.1":{"type":"STRONG","start":346,"end":352,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_3":{"id":"fe0bdba4209c_3","name":"5d19","type":"P","href":null,"layout":null,"metadata":null,"text":"First, let’s learn about what exactly an environment is. An environment contains all the necessary functionality to run an agent and allow it to learn. Each environment must implement the following gym interface:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_3.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_3.markups.0":{"type":"EM","start":198,"end":201,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_4":{"id":"fe0bdba4209c_4","name":"1d16","type":"PRE","href":null,"layout":null,"metadata":null,"text":"import gym\nfrom gym import spaces\n\nclass CustomEnv(gym.Env):\n  \"\"\"Custom Environment that follows gym interface\"\"\"\n  metadata = {'render.modes': ['human']}\n\n  def __init__(self, arg1, arg2, ...):\n    super(CustomEnv, self).__init__()","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_4.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_4.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_4.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_4.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_4.markups.4","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_4.markups.5","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_4.markups.6","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_4.markups.0":{"type":"STRONG","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_4.markups.1":{"type":"STRONG","start":11,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_4.markups.2":{"type":"STRONG","start":20,"end":26,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_4.markups.3":{"type":"STRONG","start":35,"end":40,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_4.markups.4":{"type":"STRONG","start":41,"end":50,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_4.markups.5":{"type":"STRONG","start":159,"end":162,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_4.markups.6":{"type":"EM","start":63,"end":114,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_5":{"id":"fe0bdba4209c_5","name":"a1b2","type":"PRE","href":null,"layout":null,"metadata":null,"text":"    # Define action and observation space\n    # They must be gym.spaces objects","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_5.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_5.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_5.markups.0":{"type":"EM","start":4,"end":41,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_5.markups.1":{"type":"EM","start":46,"end":79,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_6":{"id":"fe0bdba4209c_6","name":"f3bb","type":"PRE","href":null,"layout":null,"metadata":null,"text":"    # Example when using discrete actions:\n    self.action_space = spaces.Discrete(N_DISCRETE_ACTIONS)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_6.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_6.markups.0":{"type":"EM","start":4,"end":42,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_7":{"id":"fe0bdba4209c_7","name":"3019","type":"PRE","href":null,"layout":null,"metadata":null,"text":"    # Example for using image as input:\n    self.observation_space = spaces.Box(low=0, high=255, shape=\n                    (HEIGHT, WIDTH, N_CHANNELS), dtype=np.uint8)\n\n  def step(self, action):\n    # Execute one time step within the environment\n    ...","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_7.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_7.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_7.markups.0":{"type":"STRONG","start":172,"end":175,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_7.markups.1":{"type":"EM","start":0,"end":39,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_8":{"id":"fe0bdba4209c_8","name":"a5b4","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  def reset(self):\n    # Reset the state of the environment to an initial state\n    ...","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_8.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_8.markups.0":{"type":"STRONG","start":2,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_9":{"id":"fe0bdba4209c_9","name":"1601","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  def render(self, mode='human', close=False):\n    # Render the environment to the screen\n    ...","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_9.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_9.markups.0":{"type":"STRONG","start":2,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_10":{"id":"fe0bdba4209c_10","name":"7622","type":"P","href":null,"layout":null,"metadata":null,"text":"In the constructor, we first define the type and shape of our action_space, which will contain all of the actions possible for an agent to take in the environment. Similarly, we’ll define the observation_space, which contains all of the environment’s data to be observed by the agent.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_10.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_10.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_10.markups.0":{"type":"CODE","start":62,"end":74,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_10.markups.1":{"type":"CODE","start":192,"end":209,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_11":{"id":"fe0bdba4209c_11","name":"1814","type":"P","href":null,"layout":null,"metadata":null,"text":"Our reset method will be called to periodically reset the environment to an initial state. This is followed by many steps through the environment, in which an action will be provided by the model and must be executed, and the next observation returned. This is also where rewards are calculated, more on this later.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_11.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_11.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_11.markups.0":{"type":"CODE","start":4,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_11.markups.1":{"type":"CODE","start":116,"end":120,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_12":{"id":"fe0bdba4209c_12","name":"00bc","type":"P","href":null,"layout":null,"metadata":null,"text":"Finally, the render method may be called periodically to print a rendition of the environment. This could be as simple as a print statement, or as complicated as rendering a 3D environment using openGL. For this example, we will stick with print statements.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_12.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_12.markups.0":{"type":"CODE","start":13,"end":19,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_13":{"id":"fe0bdba4209c_13","name":"f647","type":"H3","href":null,"layout":null,"metadata":null,"text":"Stock Trading Environment","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_13.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_13.markups.0":{"type":"STRONG","start":0,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_14":{"id":"fe0bdba4209c_14","name":"4836","type":"P","href":null,"layout":null,"metadata":null,"text":"To demonstrate how this all works, we are going to create a stock trading environment. We will then train our agent to become a profitable trader within the environment. Let’s get started!","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_15":{"id":"fe0bdba4209c_15","name":"6c1f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*3UNtfZrmEiv3XFKs_xaRcA.jpeg","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*3UNtfZrmEiv3XFKs_xaRcA.jpeg":{"id":"1*3UNtfZrmEiv3XFKs_xaRcA.jpeg","originalHeight":3456,"originalWidth":4608,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:fe0bdba4209c_16":{"id":"fe0bdba4209c_16","name":"ad8b","type":"P","href":null,"layout":null,"metadata":null,"text":"The first thing we’ll need to consider is how a human trader would perceive their environment. What observations would they make before deciding to make a trade?","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_17":{"id":"fe0bdba4209c_17","name":"16bf","type":"P","href":null,"layout":null,"metadata":null,"text":"A trader would most likely look at some charts of a stock’s price action, perhaps overlaid with a couple technical indicators. From there, they would combine this visual information with their prior knowledge of similar price action to make an informed decision of which direction the stock is likely to move.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_18":{"id":"fe0bdba4209c_18","name":"bfd7","type":"P","href":null,"layout":null,"metadata":null,"text":"So let’s translate this into how our agent should perceive its environment.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_19":{"id":"fe0bdba4209c_19","name":"cafe","type":"P","href":null,"layout":null,"metadata":null,"text":"Our observation_space contains all of the input variables we want our agent to consider before making, or not making a trade. In this example, we want our agent to “see” the stock data points (open price, high, low, close, and daily volume) for the last five days, as well a couple other data points like its account balance, current stock positions, and current profit.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_19.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_19.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_19.markups.0":{"type":"CODE","start":4,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_19.markups.1":{"type":"EM","start":103,"end":116,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_20":{"id":"fe0bdba4209c_20","name":"b82b","type":"P","href":null,"layout":null,"metadata":null,"text":"The intuition here is that for each time step, we want our agent to consider the price action leading up to the current price, as well as their own portfolio’s status in order to make an informed decision for the next action.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_21":{"id":"fe0bdba4209c_21","name":"5387","type":"P","href":null,"layout":null,"metadata":null,"text":"Once a trader has perceived their environment, they need to take an action. In our agent’s case, its action_space will consist of three possibilities: buy a stock, sell a stock, or do nothing.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_21.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_21.markups.0":{"type":"CODE","start":101,"end":113,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_22":{"id":"fe0bdba4209c_22","name":"142d","type":"P","href":null,"layout":null,"metadata":null,"text":"But this isn’t enough; we need to know the amount of a given stock to buy or sell each time. Using gym’s Box space, we can create an action space that has a discrete number of action types (buy, sell, and hold), as well as a continuous spectrum of amounts to buy\u002Fsell (0-100% of the account balance\u002Fposition size respectively).","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_22.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_22.markups.0":{"type":"CODE","start":105,"end":108,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_23":{"id":"fe0bdba4209c_23","name":"c783","type":"P","href":null,"layout":null,"metadata":null,"text":"You’ll notice the amount is not necessary for the hold action, but will be provided anyway. Our agent does not initially know this, but over time should learn that the amount is extraneous for this action.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_24":{"id":"fe0bdba4209c_24","name":"8094","type":"P","href":null,"layout":null,"metadata":null,"text":"The last thing to consider before implementing our environment is the reward. We want to incentivize profit that is sustained over long periods of time. At each step, we will set the reward to the account balance multiplied by some fraction of the number of time steps so far.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_25":{"id":"fe0bdba4209c_25","name":"c2e3","type":"P","href":null,"layout":null,"metadata":null,"text":"The purpose of this is to delay rewarding the agent too fast in the early stages and allow it to explore sufficiently before optimizing a single strategy too deeply. It will also reward agents that maintain a higher balance for longer, rather than those who rapidly gain money using unsustainable strategies.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_26":{"id":"fe0bdba4209c_26","name":"2849","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":{"type":"id","generated":true,"id":"$Paragraph:fe0bdba4209c_26.iframe","typename":"Iframe"},"mixtapeMetadata":null},"MediaResource:b1f8649b723a835aca253d9019b93625":{"id":"b1f8649b723a835aca253d9019b93625","iframeSrc":"https:\u002F\u002Fcdn.embedly.com\u002Fwidgets\u002Fmedia.html?src=https%3A%2F%2Fupscri.be%2F6b7140%3Fas_embed%3Dtrue&dntp=1&url=https%3A%2F%2Fupscri.be%2F6b7140%2F&image=http%3A%2F%2Fapi.screenshotlayer.com%2Fapi%2Fcapture%3Faccess_key%3Dfe59908dad3baab69ffab249a2224b03%26viewport%3D1024x612%26width%3D1000%26url%3Dhttps%253A%252F%252Fupscri.be%252F6b7140%253Fscreenshot&key=a19fcc184b9711e1b4764040d3dc5c07&type=text%2Fhtml&schema=upscri","iframeHeight":400,"iframeWidth":800,"title":"Want to be notified every time I post?","__typename":"MediaResource"},"$Paragraph:fe0bdba4209c_26.iframe":{"mediaResource":{"type":"id","generated":false,"id":"MediaResource:b1f8649b723a835aca253d9019b93625","typename":"MediaResource"},"__typename":"Iframe"},"Paragraph:fe0bdba4209c_27":{"id":"fe0bdba4209c_27","name":"8430","type":"H4","href":null,"layout":null,"metadata":null,"text":"Implementation","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_28":{"id":"fe0bdba4209c_28","name":"a8a9","type":"P","href":null,"layout":null,"metadata":null,"text":"Now that we’ve defined our observation space, action space, and rewards, it’s time to implement our environment. First, we need define the action_space and observation_space in the environment’s constructor. The environment expects a pandas data frame to be passed in containing the stock data to be learned from. An example is provided in the Github repo.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_28.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_28.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_28.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_28.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_28.markups.4","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_28.markups.0":{"type":"CODE","start":139,"end":151,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_28.markups.1":{"type":"CODE","start":156,"end":173,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_28.markups.2":{"type":"CODE","start":234,"end":240,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_28.markups.3":{"type":"A","start":344,"end":355,"href":"https:\u002F\u002Fgithub.com\u002Fadamjking3\u002FStock-Trading-Environment","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_28.markups.4":{"type":"STRONG","start":344,"end":355,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_29":{"id":"fe0bdba4209c_29","name":"aa16","type":"PRE","href":null,"layout":null,"metadata":null,"text":"class StockTradingEnvironment(gym.Env):\n  \"\"\"A stock trading environment for OpenAI gym\"\"\"\n  metadata = {'render.modes': ['human']}","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_29.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_29.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_29.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_29.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_29.markups.4","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_29.markups.0":{"type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_29.markups.1":{"type":"STRONG","start":6,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_29.markups.2":{"type":"EM","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_29.markups.3":{"type":"EM","start":30,"end":33,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_29.markups.4":{"type":"EM","start":34,"end":37,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_30":{"id":"fe0bdba4209c_30","name":"abbf","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  def __init__(self, df):\n    super(StockTradingEnv, self).__init__()\n    self.df = df\n    self.reward_range = (0, MAX_ACCOUNT_BALANCE) ","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_30.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_30.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_30.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_30.markups.0":{"type":"STRONG","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_30.markups.1":{"type":"EM","start":15,"end":23,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_30.markups.2":{"type":"EM","start":30,"end":35,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_31":{"id":"fe0bdba4209c_31","name":"dfd1","type":"PRE","href":null,"layout":null,"metadata":null,"text":"    # Actions of the format Buy x%, Sell x%, Hold, etc.\n    self.action_space = spaces.Box(\n      low=np.array([0, 0]), high=np.array([3, 1]), dtype=np.float16)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_31.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_31.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_31.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_31.markups.0":{"type":"EM","start":98,"end":101,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_31.markups.1":{"type":"EM","start":120,"end":124,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_31.markups.2":{"type":"EM","start":143,"end":148,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_32":{"id":"fe0bdba4209c_32","name":"8d7c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"    # Prices contains the OHCL values for the last five prices\n    self.observation_space = spaces.Box(\n      low=0, high=1, shape=(6, 6), dtype=np.float16)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_32.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_32.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_32.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_32.markups.3","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_32.markups.0":{"type":"EM","start":110,"end":113,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_32.markups.1":{"type":"EM","start":117,"end":121,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_32.markups.2":{"type":"EM","start":125,"end":130,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_32.markups.3":{"type":"EM","start":139,"end":144,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_33":{"id":"fe0bdba4209c_33","name":"d782","type":"P","href":null,"layout":null,"metadata":null,"text":"Next, we’ll write the reset method, which is called any time a new environment is created or to reset an existing environment’s state. It’s here where we’ll set the starting balance of each agent and initialize its open positions to an empty list.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_33.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_33.markups.0":{"type":"CODE","start":22,"end":27,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_34":{"id":"fe0bdba4209c_34","name":"f9bd","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def reset(self):\n  # Reset the state of the environment to an initial state\n  self.balance = INITIAL_ACCOUNT_BALANCE\n  self.net_worth = INITIAL_ACCOUNT_BALANCE\n  self.max_net_worth = INITIAL_ACCOUNT_BALANCE\n  self.shares_held = 0\n  self.cost_basis = 0\n  self.total_shares_sold = 0\n  self.total_sales_value = 0\n \n  # Set the current step to a random point within the data frame\n  self.current_step = random.randint(0, len(self.df.loc[:, 'Open'].values) - 6)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_34.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_34.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_34.markups.0":{"type":"STRONG","start":0,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_34.markups.1":{"type":"EM","start":10,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_35":{"id":"fe0bdba4209c_35","name":"9151","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  return self._next_observation()","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_35.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_35.markups.0":{"type":"STRONG","start":2,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_36":{"id":"fe0bdba4209c_36","name":"e33c","type":"P","href":null,"layout":null,"metadata":null,"text":"We set the current step to a random point within the data frame, because it essentially gives our agent’s more unique experiences from the same data set. The _next_observation method compiles the stock data for the last five time steps, appends the agent’s account information, and scales all the values to between 0 and 1.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_36.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_36.markups.0":{"type":"CODE","start":158,"end":175,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_37":{"id":"fe0bdba4209c_37","name":"a801","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def _next_observation(self):\n  # Get the data points for the last 5 days and scale to between 0-1\n  frame = np.array([\n    self.df.loc[self.current_step: self.current_step +\n                5, 'Open'].values \u002F MAX_SHARE_PRICE,\n    self.df.loc[self.current_step: self.current_step +\n                5, 'High'].values \u002F MAX_SHARE_PRICE,\n    self.df.loc[self.current_step: self.current_step +\n                5, 'Low'].values \u002F MAX_SHARE_PRICE,\n    self.df.loc[self.current_step: self.current_step +\n                5, 'Close'].values \u002F MAX_SHARE_PRICE,\n    self.df.loc[self.current_step: self.current_step +\n                5, 'Volume'].values \u002F MAX_NUM_SHARES,\n   ])","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_37.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_37.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_37.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_37.markups.0":{"type":"STRONG","start":0,"end":3,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_37.markups.1":{"type":"EM","start":0,"end":3,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_37.markups.2":{"type":"EM","start":22,"end":26,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_38":{"id":"fe0bdba4209c_38","name":"7e4c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  # Append additional data and scale each value to between 0-1\n  obs = np.append(frame, [[\n    self.balance \u002F MAX_ACCOUNT_BALANCE,\n    self.max_net_worth \u002F MAX_ACCOUNT_BALANCE,\n    self.shares_held \u002F MAX_NUM_SHARES,\n    self.cost_basis \u002F MAX_SHARE_PRICE,\n    self.total_shares_sold \u002F MAX_NUM_SHARES,\n    self.total_sales_value \u002F (MAX_NUM_SHARES * MAX_SHARE_PRICE),\n  ]], axis=0)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_38.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_38.markups.0":{"type":"EM","start":371,"end":375,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_39":{"id":"fe0bdba4209c_39","name":"1050","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  return obs","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_39.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_39.markups.0":{"type":"STRONG","start":2,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_40":{"id":"fe0bdba4209c_40","name":"1465","type":"P","href":null,"layout":null,"metadata":null,"text":"Next, our environment needs to be able to take a step. At each step we will take the specified action (chosen by our model), calculate the reward, and return the next observation.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_40.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_40.markups.0":{"type":"CODE","start":49,"end":53,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_41":{"id":"fe0bdba4209c_41","name":"937f","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def step(self, action):\n  # Execute one time step within the environment\n  self._take_action(action)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_41.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_41.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_41.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_41.markups.3","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_41.markups.0":{"type":"STRONG","start":0,"end":3,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_41.markups.1":{"type":"EM","start":0,"end":3,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_41.markups.2":{"type":"EM","start":9,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_41.markups.3":{"type":"EM","start":15,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_42":{"id":"fe0bdba4209c_42","name":"550b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  self.current_step += 1","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_43":{"id":"fe0bdba4209c_43","name":"5a5a","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  if self.current_step \u003E len(self.df.loc[:, 'Open'].values) - 6:\n    self.current_step = 0","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_43.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_43.markups.0":{"type":"STRONG","start":2,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_44":{"id":"fe0bdba4209c_44","name":"4b9e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  delay_modifier = (self.current_step \u002F MAX_STEPS)\n  \n  reward = self.balance * delay_modifier\n  done = self.net_worth \u003C= 0","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_45":{"id":"fe0bdba4209c_45","name":"91a8","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  obs = self._next_observation()","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_46":{"id":"fe0bdba4209c_46","name":"8463","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  return obs, reward, done, {}","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_46.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_46.markups.0":{"type":"STRONG","start":2,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_47":{"id":"fe0bdba4209c_47","name":"bec8","type":"P","href":null,"layout":null,"metadata":null,"text":"Now, our _take_action method needs to take the action provided by the model and either buy, sell, or hold the stock.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_47.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_47.markups.0":{"type":"CODE","start":9,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_48":{"id":"fe0bdba4209c_48","name":"0f28","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def _take_action(self, action):\n  # Set the current price to a random price within the time step\n  current_price = random.uniform(\n    self.df.loc[self.current_step, \"Open\"],\n    self.df.loc[self.current_step, \"Close\"])","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_48.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_48.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_48.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_48.markups.3","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_48.markups.0":{"type":"STRONG","start":0,"end":3,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_48.markups.1":{"type":"EM","start":0,"end":3,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_48.markups.2":{"type":"EM","start":17,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_48.markups.3":{"type":"EM","start":23,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_49":{"id":"fe0bdba4209c_49","name":"5ccd","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  action_type = action[0]\n  amount = action[1]","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_50":{"id":"fe0bdba4209c_50","name":"6ee5","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  if action_type \u003C 1:\n    # Buy amount % of balance in shares\n    total_possible = self.balance \u002F current_price\n    shares_bought = total_possible * amount\n    prev_cost = self.cost_basis * self.shares_held\n    additional_cost = shares_bought * current_price","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_50.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_50.markups.0":{"type":"STRONG","start":0,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_51":{"id":"fe0bdba4209c_51","name":"d0d4","type":"PRE","href":null,"layout":null,"metadata":null,"text":"    self.balance -= additional_cost\n    self.cost_basis = (prev_cost + additional_cost) \u002F \n                            (self.shares_held + shares_bought)\n    self.shares_held += shares_bought","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_52":{"id":"fe0bdba4209c_52","name":"247d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  elif actionType \u003C 2:\n    # Sell amount % of shares held\n    shares_sold = self.shares_held * amount . \n    self.balance += shares_sold * current_price\n    self.shares_held -= shares_sold\n    self.total_shares_sold += shares_sold\n    self.total_sales_value += shares_sold * current_price","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_52.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_52.markups.0":{"type":"STRONG","start":2,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_53":{"id":"fe0bdba4209c_53","name":"a65b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  self.netWorth = self.balance + self.shares_held * current_price","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_54":{"id":"fe0bdba4209c_54","name":"210a","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  if self.net_worth \u003E self.max_net_worth:\n    self.max_net_worth = net_worth","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_54.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_54.markups.0":{"type":"STRONG","start":2,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_55":{"id":"fe0bdba4209c_55","name":"6fbe","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  if self.shares_held == 0:\n    self.cost_basis = 0","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_55.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_55.markups.0":{"type":"STRONG","start":2,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_56":{"id":"fe0bdba4209c_56","name":"58f4","type":"P","href":null,"layout":null,"metadata":null,"text":"The only thing left to do now is render the environment to the screen. For simplicity’s sake, we will just render the profit made so far and a couple other interesting metrics.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_56.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_56.markups.0":{"type":"CODE","start":33,"end":39,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_57":{"id":"fe0bdba4209c_57","name":"095d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def render(self, mode='human', close=False):\n  # Render the environment to the screen\n  profit = self.net_worth - INITIAL_ACCOUNT_BALANCE","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_57.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_57.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_57.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_57.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_57.markups.4","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_57.markups.0":{"type":"STRONG","start":0,"end":3,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_57.markups.1":{"type":"EM","start":0,"end":3,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_57.markups.2":{"type":"EM","start":11,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_57.markups.3":{"type":"EM","start":17,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_57.markups.4":{"type":"EM","start":31,"end":36,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_58":{"id":"fe0bdba4209c_58","name":"c1b1","type":"PRE","href":null,"layout":null,"metadata":null,"text":"  print(f'Step: {self.current_step}')\n  print(f'Balance: {self.balance}')\n  print(f'Shares held: {self.shares_held}\n          (Total sold: {self.total_shares_sold})')\n  print(f'Avg cost for held shares: {self.cost_basis}\n          (Total sales value: {self.total_sales_value})')\n  print(f'Net worth: {self.net_worth}\n          (Max net worth: {self.max_net_worth})')\n  print(f'Profit: {profit}')","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_58.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_58.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_58.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_58.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_58.markups.4","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_58.markups.5","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_58.markups.0":{"type":"EM","start":8,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_58.markups.1":{"type":"EM","start":46,"end":47,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_58.markups.2":{"type":"EM","start":82,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_58.markups.3":{"type":"EM","start":175,"end":176,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_58.markups.4":{"type":"EM","start":287,"end":288,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_58.markups.5":{"type":"EM","start":375,"end":376,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_59":{"id":"fe0bdba4209c_59","name":"647d","type":"P","href":null,"layout":null,"metadata":null,"text":"Our environment is complete. We can now instantiate a StockTradingEnv environment with a data frame and test it with a model from stable-baselines.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_59.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_59.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_59.markups.0":{"type":"CODE","start":54,"end":69,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_59.markups.1":{"type":"A","start":130,"end":146,"href":"https:\u002F\u002Fgithub.com\u002Fhill-a\u002Fstable-baselines","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_60":{"id":"fe0bdba4209c_60","name":"448e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"import gym\nimport json\nimport datetime as dt","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_60.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_60.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_60.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_60.markups.3","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_60.markups.0":{"type":"STRONG","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_60.markups.1":{"type":"STRONG","start":11,"end":17,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_60.markups.2":{"type":"STRONG","start":23,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_60.markups.3":{"type":"STRONG","start":39,"end":41,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_61":{"id":"fe0bdba4209c_61","name":"7e33","type":"PRE","href":null,"layout":null,"metadata":null,"text":"from stable_baselines.common.policies import MlpPolicy\nfrom stable_baselines.common.vec_env import DummyVecEnv\nfrom stable_baselines import PPO2","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_61.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_61.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_61.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_61.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_61.markups.4","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_61.markups.5","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_61.markups.0":{"type":"STRONG","start":0,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_61.markups.1":{"type":"STRONG","start":38,"end":44,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_61.markups.2":{"type":"STRONG","start":55,"end":59,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_61.markups.3":{"type":"STRONG","start":92,"end":98,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_61.markups.4":{"type":"STRONG","start":111,"end":115,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_61.markups.5":{"type":"STRONG","start":133,"end":139,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_62":{"id":"fe0bdba4209c_62","name":"f349","type":"PRE","href":null,"layout":null,"metadata":null,"text":"from env.StockTradingEnv import StockTradingEnv","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_62.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_62.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_62.markups.0":{"type":"STRONG","start":0,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_62.markups.1":{"type":"STRONG","start":25,"end":31,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_63":{"id":"fe0bdba4209c_63","name":"7ac0","type":"PRE","href":null,"layout":null,"metadata":null,"text":"import pandas as pd","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_63.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_63.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_63.markups.0":{"type":"STRONG","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_63.markups.1":{"type":"STRONG","start":14,"end":16,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_64":{"id":"fe0bdba4209c_64","name":"1acb","type":"PRE","href":null,"layout":null,"metadata":null,"text":"df = pd.read_csv('.\u002Fdata\u002FAAPL.csv')\ndf = df.sort_values('Date')","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_65":{"id":"fe0bdba4209c_65","name":"9acb","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# The algorithms require a vectorized environment to run\nenv = DummyVecEnv([lambda: StockTradingEnv(df)])","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_65.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_65.markups.0":{"type":"EM","start":76,"end":82,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_66":{"id":"fe0bdba4209c_66","name":"3605","type":"PRE","href":null,"layout":null,"metadata":null,"text":"model = PPO2(MlpPolicy, env, verbose=1)\nmodel.learn(total_timesteps=20000)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_66.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_66.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_66.markups.0":{"type":"EM","start":29,"end":36,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_66.markups.1":{"type":"EM","start":52,"end":67,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_67":{"id":"fe0bdba4209c_67","name":"f5d3","type":"PRE","href":null,"layout":null,"metadata":null,"text":"obs = env.reset()\nfor i in range(2000):\n  action, _states = model.predict(obs)\n  obs, rewards, done, info = env.step(action)\n  env.render()","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_67.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_67.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_67.markups.0":{"type":"STRONG","start":18,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_67.markups.1":{"type":"STRONG","start":24,"end":26,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_68":{"id":"fe0bdba4209c_68","name":"ca7c","type":"P","href":null,"layout":null,"metadata":null,"text":"Now of course, this was all just for fun to test out creating an interesting, custom gym environment with some semi-complex actions, observations, and reward spaces. It’s going to take a lot more time and effort if we really want to get rich with deep learning in the stock market…","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_69":{"id":"fe0bdba4209c_69","name":"1ee8","type":"P","href":null,"layout":null,"metadata":null,"text":"Stay tuned for next week’s article where we’ll learn to create simple, yet elegant visualizations of our environments!","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_69.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_69.markups.0":{"type":"A","start":56,"end":117,"href":"https:\u002F\u002Ftowardsdatascience.com\u002Fvisualizing-stock-trading-agents-using-matplotlib-and-gym-584c992bc6d4","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_70":{"id":"fe0bdba4209c_70","name":"ad15","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Creating Bitcoin trading bots that don’t lose money\nLet’s make profitable cryptocurrency trading agents using deep reinforcement learningtowardsdatascience.com","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_70.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_70.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_70.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":{"type":"id","generated":true,"id":"$Paragraph:fe0bdba4209c_70.mixtapeMetadata","typename":"MixtapeMetadata"}},"Paragraph:fe0bdba4209c_70.markups.0":{"type":"A","start":0,"end":159,"href":"https:\u002F\u002Ftowardsdatascience.com\u002Fcreating-bitcoin-trading-bots-that-dont-lose-money-2e7165fb0b29","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_70.markups.1":{"type":"STRONG","start":0,"end":51,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_70.markups.2":{"type":"EM","start":52,"end":137,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Paragraph:fe0bdba4209c_70.mixtapeMetadata":{"href":"https:\u002F\u002Ftowardsdatascience.com\u002Fcreating-bitcoin-trading-bots-that-dont-lose-money-2e7165fb0b29","thumbnailImageId":"1*r7XItmcyWv76mso08vncpw.jpeg","__typename":"MixtapeMetadata"},"Paragraph:fe0bdba4209c_71":{"id":"fe0bdba4209c_71","name":"1bab","type":"P","href":null,"layout":null,"metadata":null,"text":"Thanks for reading! As always, all of the code for this tutorial can be found on my GitHub. Leave a comment below if you have any questions or feedback, I’d love to hear from you! I can also be reached on Twitter at @notadamking.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_71.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_71.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_71.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_71.markups.0":{"type":"A","start":84,"end":90,"href":"https:\u002F\u002Fgithub.com\u002Fnotadamking\u002FStock-Trading-Environment","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_71.markups.1":{"type":"A","start":205,"end":212,"href":"https:\u002F\u002Ftwitter.com\u002Fnotadamking","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_71.markups.2":{"type":"EM","start":0,"end":229,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_72":{"id":"fe0bdba4209c_72","name":"33fe","type":"P","href":null,"layout":null,"metadata":null,"text":"You can also sponsor me on Github Sponsors or Patreon via the links below.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_72.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_72.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_72.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_72.markups.0":{"type":"A","start":27,"end":42,"href":"https:\u002F\u002Fgithub.com\u002Fusers\u002Fnotadamking\u002Fsponsorship","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_72.markups.1":{"type":"A","start":46,"end":53,"href":"https:\u002F\u002Fwww.patreon.com\u002Fjoin\u002Fnotadamking","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_72.markups.2":{"type":"EM","start":0,"end":74,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_73":{"id":"fe0bdba4209c_73","name":"c289","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sponsor @notadamking on GitHub Sponsors\nHi, I’m Adam. I’m a developer, writer, and entrepreneur, specifically interested in financial applications of deep…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_73.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_73.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_73.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":{"type":"id","generated":true,"id":"$Paragraph:fe0bdba4209c_73.mixtapeMetadata","typename":"MixtapeMetadata"}},"Paragraph:fe0bdba4209c_73.markups.0":{"type":"A","start":0,"end":165,"href":"https:\u002F\u002Fgithub.com\u002Fusers\u002Fnotadamking\u002Fsponsorship","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_73.markups.1":{"type":"STRONG","start":0,"end":39,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_73.markups.2":{"type":"EM","start":40,"end":155,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Paragraph:fe0bdba4209c_73.mixtapeMetadata":{"href":"https:\u002F\u002Fgithub.com\u002Fusers\u002Fnotadamking\u002Fsponsorship","thumbnailImageId":"0*P72bPmqLD2-R47En","__typename":"MixtapeMetadata"},"Paragraph:fe0bdba4209c_74":{"id":"fe0bdba4209c_74","name":"d9fb","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Github Sponsors is currently matching all donations 1:1 up to $5,000!","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:fe0bdba4209c_75":{"id":"fe0bdba4209c_75","name":"0366","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Adam King is creating World Changing Content | Patreon\nHi, I’m Adam. I’m a developer, writer, and entrepreneur, specifically interested in financial applications of deep…patreon.com","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_75.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_75.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:fe0bdba4209c_75.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":{"type":"id","generated":true,"id":"$Paragraph:fe0bdba4209c_75.mixtapeMetadata","typename":"MixtapeMetadata"}},"Paragraph:fe0bdba4209c_75.markups.0":{"type":"A","start":0,"end":181,"href":"https:\u002F\u002Fpatreon.com\u002Fnotadamking","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_75.markups.1":{"type":"STRONG","start":0,"end":54,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:fe0bdba4209c_75.markups.2":{"type":"EM","start":55,"end":170,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"$Paragraph:fe0bdba4209c_75.mixtapeMetadata":{"href":"https:\u002F\u002Fpatreon.com\u002Fnotadamking","thumbnailImageId":"0*1J-9dzACdixhIcDA","__typename":"MixtapeMetadata"},"Tag:machine-learning":{"id":"machine-learning","displayTitle":"Machine Learning","__typename":"Tag"},"Tag:stock-trading":{"id":"stock-trading","displayTitle":"Stock Trading","__typename":"Tag"},"Tag:deep-learning":{"id":"deep-learning","displayTitle":"Deep Learning","__typename":"Tag"},"Tag:openai-gym":{"id":"openai-gym","displayTitle":"Openai Gym","__typename":"Tag"},"Tag:stock-market":{"id":"stock-market","displayTitle":"Stock Market","__typename":"Tag"},"$Post:be532be3910e.recirc({\"paging\":{\"limit\":3}}).items.0":{"__typename":"SuggestedPost","post":{"type":"id","generated":false,"id":"Post:978f4be1e6d","typename":"Post"},"postSuggestionReasons":[{"type":"id","generated":true,"id":"$Post:be532be3910e.recirc({\"paging\":{\"limit\":3}}).items.0.postSuggestionReasons.0","typename":"PostSuggestionReason"}]},"Post:978f4be1e6d":{"__typename":"Post","id":"978f4be1e6d","title":"Top 3 Python Functions You Don’t Know About (Probably)","isLocked":true,"previewImage":{"type":"id","generated":false,"id":"ImageMetadata:0*ZSR2HwcRxTMtyDBM","typename":"ImageMetadata"},"isPublished":true,"mediumUrl":"https:\u002F\u002Ftowardsdatascience.com\u002Ftop-3-python-functions-you-dont-know-about-probably-978f4be1e6d","firstPublishedAt":1584203589473,"readingTime":3.7257861635220126,"statusForCollection":"APPROVED","visibility":"LOCKED","collection":{"type":"id","generated":false,"id":"Collection:7f60cf5620c9","typename":"Collection"},"creator":{"type":"id","generated":false,"id":"User:689ba04bb8be","typename":"User"},"previewContent":{"type":"id","generated":true,"id":"$Post:978f4be1e6d.previewContent","typename":"PreviewContent"},"readingList":"READING_LIST_NONE","clapCount":2843,"viewerClapCount":0,"isLimitedState":false,"voterCount":1003,"recommenders":[]},"ImageMetadata:0*ZSR2HwcRxTMtyDBM":{"id":"0*ZSR2HwcRxTMtyDBM","focusPercentX":null,"focusPercentY":null,"__typename":"ImageMetadata"},"User:689ba04bb8be":{"name":"Dario Radečić","username":"radecicdario","id":"689ba04bb8be","bio":"A 23-year-old student of Data Science — also working in the field. Writer at Medium and Towards Data Science.","isFollowing":false,"imageId":"2*VmdbajrpX9nwOc9UtkV3Yg.png","mediumMemberAt":1566814839000,"__typename":"User"},"$Post:978f4be1e6d.previewContent":{"isFullContent":false,"__typename":"PreviewContent"},"$Post:be532be3910e.recirc({\"paging\":{\"limit\":3}}).items.0.postSuggestionReasons.0":{"reason":"TOP_IN_COLLECTION","users":[],"topics":[],"collections":[{"type":"id","generated":true,"id":"$Post:be532be3910e.recirc({\"paging\":{\"limit\":3}}).items.0.postSuggestionReasons.0.collections.0","typename":"SuggestionReasonCollection"}],"tags":[],"__typename":"PostSuggestionReason"},"$Post:be532be3910e.recirc({\"paging\":{\"limit\":3}}).items.0.postSuggestionReasons.0.collections.0":{"name":"Towards Data Science","__typename":"SuggestionReasonCollection"},"$Post:be532be3910e.recirc({\"paging\":{\"limit\":3}}).items.1":{"__typename":"SuggestedPost","post":{"type":"id","generated":false,"id":"Post:e40d9c71f4e2","typename":"Post"},"postSuggestionReasons":[{"type":"id","generated":true,"id":"$Post:be532be3910e.recirc({\"paging\":{\"limit\":3}}).items.1.postSuggestionReasons.0","typename":"PostSuggestionReason"}]},"Post:e40d9c71f4e2":{"__typename":"Post","id":"e40d9c71f4e2","title":"I Thought I Was Mastering Python Until I Discovered These Tricks","isLocked":true,"previewImage":{"type":"id","generated":false,"id":"ImageMetadata:1*0zc5FpwQKOm5d7bIbozXCA.jpeg","typename":"ImageMetadata"},"isPublished":true,"mediumUrl":"https:\u002F\u002Ftowardsdatascience.com\u002Fi-thought-i-was-mastering-python-until-i-discovered-these-tricks-e40d9c71f4e2","firstPublishedAt":1583459016778,"readingTime":8.402830188679246,"statusForCollection":"APPROVED","visibility":"LOCKED","collection":{"type":"id","generated":false,"id":"Collection:7f60cf5620c9","typename":"Collection"},"creator":{"type":"id","generated":false,"id":"User:22f56f58cc0b","typename":"User"},"previewContent":{"type":"id","generated":true,"id":"$Post:e40d9c71f4e2.previewContent","typename":"PreviewContent"},"readingList":"READING_LIST_NONE","clapCount":3931,"viewerClapCount":0,"isLimitedState":false,"voterCount":1584,"recommenders":[]},"ImageMetadata:1*0zc5FpwQKOm5d7bIbozXCA.jpeg":{"id":"1*0zc5FpwQKOm5d7bIbozXCA.jpeg","focusPercentX":null,"focusPercentY":null,"__typename":"ImageMetadata"},"User:22f56f58cc0b":{"name":"Kamal Chouhbi","username":"chouhbik","id":"22f56f58cc0b","bio":"Masters student (Major in Data Analytics) https:\u002F\u002Fgithub.com\u002Fchouhbik || https:\u002F\u002Fwww.linkedin.com\u002Fin\u002Fkamal-chouhbi","isFollowing":false,"imageId":"2*dOYKOKixC3TvWiKndwLu4w.jpeg","mediumMemberAt":0,"__typename":"User"},"$Post:e40d9c71f4e2.previewContent":{"isFullContent":false,"__typename":"PreviewContent"},"$Post:be532be3910e.recirc({\"paging\":{\"limit\":3}}).items.1.postSuggestionReasons.0":{"reason":"TOP_IN_COLLECTION","users":[],"topics":[],"collections":[{"type":"id","generated":true,"id":"$Post:be532be3910e.recirc({\"paging\":{\"limit\":3}}).items.1.postSuggestionReasons.0.collections.0","typename":"SuggestionReasonCollection"}],"tags":[],"__typename":"PostSuggestionReason"},"$Post:be532be3910e.recirc({\"paging\":{\"limit\":3}}).items.1.postSuggestionReasons.0.collections.0":{"name":"Towards Data Science","__typename":"SuggestionReasonCollection"},"$Post:be532be3910e.recirc({\"paging\":{\"limit\":3}}).items.2":{"__typename":"SuggestedPost","post":{"type":"id","generated":false,"id":"Post:c8c5b75503cf","typename":"Post"},"postSuggestionReasons":[{"type":"id","generated":true,"id":"$Post:be532be3910e.recirc({\"paging\":{\"limit\":3}}).items.2.postSuggestionReasons.0","typename":"PostSuggestionReason"}]},"Post:c8c5b75503cf":{"__typename":"Post","id":"c8c5b75503cf","title":"9 Reasons why you’ll never become a Data Scientist","isLocked":true,"previewImage":{"type":"id","generated":false,"id":"ImageMetadata:1*ISt7IxE0_46F5yCEspq_oQ.jpeg","typename":"ImageMetadata"},"isPublished":true,"mediumUrl":"https:\u002F\u002Ftowardsdatascience.com\u002F9-reasons-why-youll-never-become-a-data-scientist-c8c5b75503cf","firstPublishedAt":1583711614156,"readingTime":6.486163522012578,"statusForCollection":"APPROVED","visibility":"LOCKED","collection":{"type":"id","generated":false,"id":"Collection:7f60cf5620c9","typename":"Collection"},"creator":{"type":"id","generated":false,"id":"User:593908e0206","typename":"User"},"previewContent":{"type":"id","generated":true,"id":"$Post:c8c5b75503cf.previewContent","typename":"PreviewContent"},"readingList":"READING_LIST_NONE","clapCount":3066,"viewerClapCount":0,"isLimitedState":false,"voterCount":976,"recommenders":[]},"ImageMetadata:1*ISt7IxE0_46F5yCEspq_oQ.jpeg":{"id":"1*ISt7IxE0_46F5yCEspq_oQ.jpeg","focusPercentX":null,"focusPercentY":null,"__typename":"ImageMetadata"},"User:593908e0206":{"name":"Rhea Moutafis","username":"rheamoutafis","id":"593908e0206","bio":"Pursuing my PhD on Dark Matter physics. Lover of art, music and beautiful things. Queer in every sense.","isFollowing":false,"imageId":"2*8TyJoz2oyfux06hOJujerQ.jpeg","mediumMemberAt":1536302451000,"__typename":"User"},"$Post:c8c5b75503cf.previewContent":{"isFullContent":false,"__typename":"PreviewContent"},"$Post:be532be3910e.recirc({\"paging\":{\"limit\":3}}).items.2.postSuggestionReasons.0":{"reason":"TOP_IN_COLLECTION","users":[],"topics":[],"collections":[{"type":"id","generated":true,"id":"$Post:be532be3910e.recirc({\"paging\":{\"limit\":3}}).items.2.postSuggestionReasons.0.collections.0","typename":"SuggestionReasonCollection"}],"tags":[],"__typename":"PostSuggestionReason"},"$Post:be532be3910e.recirc({\"paging\":{\"limit\":3}}).items.2.postSuggestionReasons.0.collections.0":{"name":"Towards Data Science","__typename":"SuggestionReasonCollection"},"$Post:be532be3910e.recirc({\"paging\":{\"limit\":3}})":{"items":[{"type":"id","generated":true,"id":"$Post:be532be3910e.recirc({\"paging\":{\"limit\":3}}).items.0","typename":"SuggestedPost"},{"type":"id","generated":true,"id":"$Post:be532be3910e.recirc({\"paging\":{\"limit\":3}}).items.1","typename":"SuggestedPost"},{"type":"id","generated":true,"id":"$Post:be532be3910e.recirc({\"paging\":{\"limit\":3}}).items.2","typename":"SuggestedPost"}],"__typename":"RecircItemConnection"},"$Post:be532be3910e.postResponses":{"count":0,"__typename":"PostResponses","responsesConnection({\"paging\":{\"limit\":10}})":{"type":"id","generated":true,"id":"$Post:be532be3910e.postResponses.responsesConnection({\"paging\":{\"limit\":10}})","typename":"StreamConnection"}},"$Post:be532be3910e.previewContent":{"subtitle":"OpenAI’s gym is an awesome package that allows you to create custom reinforcement learning agents. It comes with quite a few pre-built…","__typename":"PreviewContent"},"$Post:be532be3910e.postResponses.responsesConnection({\"paging\":{\"limit\":10}})":{"pagingInfo":null,"stream":[],"__typename":"StreamConnection"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.7d734523.js"></script><script src="https://cdn-client.medium.com/lite/static/js/vendors~main.8effcb31.chunk.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.275deaec.chunk.js"></script><script src="https://cdn-client.medium.com/lite/static/js/vendors~screen.collection.packageBuilder~screen.collection.styleEditor~screen.debug.cachedPost~scree~21f3676b.7d5798ea.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/screen.collection.packageBuilder~screen.collection.styleEditor~screen.debug.cachedPost~screen.landin~fb9a2ae7.affa02cd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/screen.collection.styleEditor~screen.debug.cachedPost~screen.landingpages.tribute~screen.post~screen~fecfa2ed.e3a1e6b5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/screen.debug.cachedPost~screen.landingpages.tribute~screen.muted.settings~screen.post~screen.post.am~d3a2d9f2.fb4ffbda.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/screen.post.42ab5723.chunk.js"></script><script>window.main();</script></body></html>